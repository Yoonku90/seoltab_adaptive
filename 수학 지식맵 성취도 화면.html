<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>김테스트 학생 · 수학 성취도 대시보드 (2025-10-24)</title>
  <style>
    :root {
      --bg: #f8f9fa; --card: #ffffff; --border: #e9ecef; --text: #212529; --muted: #6c757d;
      --indigo: #4c6ef5; --green: #28a745; --yellow: #ffc107; --red: #dc3545; --blue: #0d6efd;
    }
    *, *::before, *::after { box-sizing: border-box; }
    body {
      margin: 0;
      font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, "Noto Sans", sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol", "Noto Color Emoji";
      font-size: 1rem;
      font-weight: 400;
      line-height: 1.5;
      color: var(--text);
      background-color: var(--bg);
    }
    .container { max-width: 960px; margin: 0 auto; padding: 24px 16px; }
    .grid { display: grid; gap: 16px; }
    @media (min-width: 992px) { .grid-4 { grid-template-columns: repeat(4, 1fr); } }
    @media (min-width: 576px) and (max-width: 991px) { .grid-4 { grid-template-columns: repeat(2, 1fr); } }
    @media (max-width: 575px) { .grid-4 { grid-template-columns: repeat(1, 1fr); } } /* Added for mobile */
    .card {
      background-color: var(--card);
      border: 1px solid var(--border);
      border-radius: 12px;
      padding: 20px;
      box-shadow: 0 4px 12px rgba(0,0,0,0.05);
    }
    .title { font-weight: 700; font-size: 1.5rem; letter-spacing: -0.5px; }
    .sub-title { font-size: 0.875rem; color: var(--muted); }
    .stat-card h3 { font-size: 0.875rem; color: var(--muted); margin: 0 0 4px 0; font-weight: 500; }
    .stat-card .score { font-size: 2.25rem; font-weight: 700; line-height: 1.1; }
    .stat-card .desc { font-size: 1rem; font-weight: 600; }
    .hbar { height: 8px; background-color: #e9ecef; border-radius: 99px; overflow: hidden; }
    .hbar > span { display: block; height: 100%; border-radius: 99px; }
    .jungdanwon-block { margin-bottom: 16px; }
    .jungdanwon-header { padding-bottom: 12px; border-bottom: 1px solid var(--border); }
    details { margin-top: 8px; }
    details > summary {
      cursor: pointer; padding: 10px; list-style: none; display: flex;
      align-items: flex-start; gap: 8px; transition: background-color 0.2s;
      border-radius: 8px; flex-wrap: wrap;
    }
    details > summary:hover { background-color: #f8f9fa; }
    details > summary::-webkit-details-marker { display: none; }
    details > summary::before {
      content: '▶'; font-size: 0.7em; margin-left: 4px; margin-top: 6px;
      transform: rotate(0deg); transition: transform 0.2s;
      flex-shrink: 0; /* Prevents shrinking */
    }
    details[open] > summary::before { transform: rotate(90deg); }
    .unit-info { flex-grow: 1; min-width: 0; }
    .unit-info .name { font-weight: 600; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; }
    .unit-info .counts { font-size: 0.875rem; color: var(--muted); }
    .unit-score { font-weight: 700; font-size: 1rem; text-align: right; min-width: 60px; white-space: nowrap; } /* Added nowrap */
    .unit-hbar { width: 100%; margin-top: 6px; flex-basis: 100%;} /* Added flex-basis */
    .action-card ol { padding-left: 20px; margin: 12px 0 0 0; }
    .action-card li { margin-bottom: 16px; }
    .action-card .goal {
      font-size: 0.875rem; margin-top: 4px; padding: 8px 12px;
      background-color: #f8f9fa; border-left: 3px solid var(--indigo);
      border-radius: 4px; color: #495057;
    }
    .kc-card { padding: 8px 12px 8px 30px; }
    .kc-card-header { display: flex; align-items: center; gap: 8px; flex-wrap: wrap; /* Allow wrapping */}
    .kc-name { flex-grow: 1; min-width: 0; font-size: 0.9rem; }
    .kc-name strong { font-family: monospace; }
    /* Adjusted max-width calculation for smaller screens */
    .kc-name span { white-space: nowrap; overflow: hidden; text-overflow: ellipsis; display: inline-block; vertical-align: bottom; max-width: calc(100% - 70px); }
     @media (min-width: 576px) { .kc-name span { max-width: calc(100% - 110px); } }
    .pill {
        padding: 2px 8px; border-radius: 99px;
        font-size: 0.8em; font-weight: 700; white-space: nowrap;
        margin-left: auto; /* Push pill to the right */
        flex-shrink: 0; /* Prevent pill shrinking */
    }
    .print-btn {
        position: fixed; bottom: 20px; right: 20px;
        background-color: var(--indigo); color: white;
        border: none; border-radius: 50%; width: 50px; height: 50px;
        box-shadow: 0 4px 15px rgba(0,0,0,0.2);
        font-size: 24px; cursor: pointer; display: grid; place-items: center;
        z-index: 1000; /* Ensure button stays on top */
    }
    @media print {
      body { -webkit-print-color-adjust: exact; print-color-adjust: exact; } /* Ensure colors print */
      .print-btn { display: none; }
      details { page-break-inside: avoid; } /* Avoid breaking details across pages */
      details summary { display: none; } /* Hide summary in print */
      .card { box-shadow: none; border: 1px solid #dee2e6; } /* Simpler border for print */
      .container { max-width: 100%; padding: 0; }
      h1, h2, h3 { page-break-after: avoid; } /* Avoid breaking after headings */
      .kc-card { padding-left: 10px; } /* Reduce indent in print */
    }
  </style>
</head>
<body>
  <div class="container">
    <header style="margin-bottom: 24px;">
      <h1 class="title">[중2-2] 기말대비 수학 성취도 대시보드</h1>
      <p class="sub-title">이름: <strong>김테스트</strong> · 최종 학습일: <strong>2025-10-24</strong></p>
    </header>

    <main>
      <!-- Summary Section: Populated by JavaScript -->
      <section class="grid grid-4" id="summary-section" style="margin-bottom: 24px;"></section>

      <!-- Detailed Analysis Section: Populated by JavaScript -->
      <section>
        <h2 style="font-size: 1.25rem; margin:0 0 12px 0;">🌳 단원별 상세 분석 (누적)</h2>
        <div id="tree-view"></div>
      </section>

      <!-- Action Items Section: Populated by JavaScript -->
      <section class="card action-card" style="margin-top: 24px;">
        <h2 style="font-size: 1.25rem; margin:0;">💡 다음 학습을 위한 제안 (누적)</h2>
        <p class="sub-title" style="margin-top: 4px;">성취도가 낮은 KC 및 미학습 KC를 중심으로 학습 목표를 확인하세요.</p>
        <div id="action-items"></div>
      </section>
    </main>

    <!-- Print Button -->
    <button class="print-btn" onclick="window.print()" title="인쇄하기">🖨️</button>
  </div>

  <script>
    document.addEventListener('DOMContentLoaded', () => {
      // ======== 1. Data Definitions ========
      // Combined raw data from multiple sessions
      const problemRawData = [
          // Session 1 Data
          {num: 1, kc: "KC-M2_2-2-2-1-03", difficulty: 3, correct: true}, {num: 2, kc: "KC-M2_2-2-2-1-07", difficulty: 3, correct: true},
          {num: 3, kc: "KC-M2_2-2-2-1-12", difficulty: 4, correct: false}, {num: 4, kc: "KC-M2_2-2-2-1-14", difficulty: 2, correct: true},
          {num: 5, kc: "KC-M2_2-2-2-2-03", difficulty: 2, correct: true}, {num: 6, kc: "KC-M2_2-2-2-2-08", difficulty: 5, correct: false},
          {num: 7, kc: "KC-M2_2-2-3-1-02", difficulty: 3, correct: true}, {num: 8, kc: "KC-M2_2-2-3-1-07", difficulty: 4, correct: true},
          {num: 9, kc: "KC-M2_2-2-3-1-09", difficulty: 2, correct: false}, {num: 10, kc: "KC-M2_2-2-3-2-01", difficulty: 5, correct: true},
          {num: 11, kc: "KC-M2_2-2-3-2-04", difficulty: 2, correct: true}, {num: 12, kc: "KC-M2_2-2-3-2-08", difficulty: 2, correct: false},
          {num: 13, kc: "KC-M2_2-3-1-1-03", difficulty: 4, correct: true}, {num: 14, kc: "KC-M2_2-3-1-1-12", difficulty: 4, correct: true},
          {num: 15, kc: "KC-M2_2-3-1-1-17", difficulty: 3, correct: false}, {num: 16, kc: "KC-M2_2-3-1-1-19", difficulty: 5, correct: true},
          {num: 17, kc: "KC-M2_2-3-1-1-24", difficulty: 5, correct: false}, {num: 18, kc: "KC-M2_2-3-1-1-27", difficulty: 4, correct: true},
          {num: 19, kc: "KC-M2_2-3-1-1-30", difficulty: 3, correct: true}, {num: 20, kc: "KC-M2_2-3-1-2-01", difficulty: 3, correct: false},
          {num: 21, kc: "KC-M2_2-3-1-2-06", difficulty: 2, correct: true}, {num: 22, kc: "KC-M2_2-3-1-3-01", difficulty: 3, correct: false},
          {num: 23, kc: "KC-M2_2-3-1-3-08", difficulty: 5, correct: true}, {num: 24, kc: "KC-M2_2-3-1-3-15", difficulty: 3, correct: true},
          {num: 25, kc: "KC-M2_2-3-1-3-17", difficulty: 5, correct: false},
          // Session 2 Data (Added from previous log)
          {num: 26, kc: "KC-M2_2-2-2-1-01", difficulty: 5, correct: true}, {num: 27, kc: "KC-M2_2-2-2-1-06", difficulty: 1, correct: true},
          {num: 28, kc: "KC-M2_2-2-2-1-11", difficulty: 3, correct: true}, {num: 29, kc: "KC-M2_2-2-2-1-16", difficulty: 3, correct: false},
          {num: 30, kc: "KC-M2_2-2-2-2-07", difficulty: 3, correct: true}, {num: 31, kc: "KC-M2_2-2-2-2-09", difficulty: 5, correct: true},
          {num: 32, kc: "KC-M2_2-2-3-1-01", difficulty: 2, correct: false}, {num: 33, kc: "KC-M2_2-2-3-1-04", difficulty: 4, correct: true},
          {num: 34, kc: "KC-M2_2-2-3-1-08", difficulty: 5, correct: true}, {num: 35, kc: "KC-M2_2-2-3-1-12", difficulty: 2, correct: false},
          {num: 36, kc: "KC-M2_2-2-3-2-05", difficulty: 4, correct: true}, {num: 37, kc: "KC-M2_2-2-3-2-07", difficulty: 2, correct: true},
          {num: 38, kc: "KC-M2_2-2-3-2-09", difficulty: 4, correct: false}, {num: 39, kc: "KC-M2_2-3-1-1-04", difficulty: 4, correct: true},
          {num: 40, kc: "KC-M2_2-3-1-1-07", difficulty: 3, correct: false}, {num: 41, kc: "KC-M2_2-3-1-1-13", difficulty: 3, correct: true},
          {num: 42, kc: "KC-M2_2-3-1-1-16", difficulty: 3, correct: true}, {num: 43, kc: "KC-M2_2-3-1-1-20", difficulty: 3, correct: true},
          {num: 44, kc: "KC-M2_2-3-1-1-29", difficulty: 3, correct: false}, {num: 45, kc: "KC-M2_2-3-1-1-32", difficulty: 4, correct: true},
          {num: 46, kc: "KC-M2_2-3-1-2-05", difficulty: 4, correct: true}, {num: 47, kc: "KC-M2_2-3-1-3-05", difficulty: 3, correct: false},
          {num: 48, kc: "KC-M2_2-3-1-3-10", difficulty: 4, correct: true}, {num: 49, kc: "KC-M2_2-3-1-3-13", difficulty: 4, correct: false},
          {num: 50, kc: "KC-M2_2-3-1-3-16", difficulty: 3, correct: true},
          // Session 3 Data (Added from previous log)
          {num: 51, kc: "KC-M2_2-2-2-2-04", difficulty: 2, correct: true}, {num: 52, kc: "KC-M2_2-2-3-1-04", difficulty: 4, correct: false},
          {num: 53, kc: "KC-M2_2-2-2-1-01", difficulty: 2, correct: true}, {num: 54, kc: "KC-M2_2-2-2-1-05", difficulty: 1, correct: true},
          {num: 55, kc: "KC-M2_2-2-2-1-10", difficulty: 2, correct: false}, {num: 56, kc: "KC-M2_2-2-2-1-15", difficulty: 1, correct: true},
          {num: 57, kc: "KC-M2_2-2-2-2-02", difficulty: 3, correct: true}, {num: 58, kc: "KC-M2_2-2-2-2-06", difficulty: 3, correct: true},
          {num: 59, kc: "KC-M2_2-2-3-1-03", difficulty: 3, correct: false}, {num: 60, kc: "KC-M2_2-2-3-1-11", difficulty: 2, correct: true},
          {num: 61, kc: "KC-M2_2-2-3-1-15", difficulty: 4, correct: true}, {num: 62, kc: "KC-M2_2-2-3-2-03", difficulty: 2, correct: false},
          {num: 63, kc: "KC-M2_2-2-3-2-06", difficulty: 3, correct: true}, {num: 64, kc: "KC-M2_2-2-3-2-12", difficulty: 4, correct: false},
          {num: 65, kc: "KC-M2_2-3-1-1-01", difficulty: 2, correct: true}, {num: 66, kc: "KC-M2_2-3-1-1-08", difficulty: 1, correct: true},
          {num: 67, kc: "KC-M2_2-3-1-1-09", difficulty: 3, correct: true}, {num: 68, kc: "KC-M2_2-3-1-1-15", difficulty: 2, correct: false},
          {num: 69, kc: "KC-M2_2-3-1-1-23", difficulty: 2, correct: true}, {num: 70, kc: "KC-M2_2-3-1-1-25", difficulty: 4, correct: true},
          {num: 71, kc: "KC-M2_2-3-1-1-28", difficulty: 4, correct: false}, {num: 72, kc: "KC-M2_2-3-1-2-01", difficulty: 3, correct: true},
          {num: 73, kc: "KC-M2_2-3-1-2-03", difficulty: 2, correct: true}, {num: 74, kc: "KC-M2_2-3-1-3-02", difficulty: 4, correct: true},
          {num: 75, kc: "KC-M2_2-3-1-3-03", difficulty: 3, correct: false}, {num: 76, kc: "KC-M2_2-3-1-3-11", difficulty: 3, correct: true},
          {num: 77, kc: "KC-M2_2-3-1-3-14", difficulty: 3, correct: false}
      ];

      // KC Metadata (provided in the prompt)
      const kcMeta = {
        "KC-M2_2-2-2-1-01": { jungdanwon: "[2-2] 닮음 도형의 성질", sodanwon: "삼각형의 무게중심", label: "삼각형의 두 변의 중점을 연결한 선분의 성질(1)", desc: "삼각형의 두 변의 중점을 연결한 선분은 나머지 한 변과 평행하고, 그 길이는 나머지 한 변의 길이의 절반임을 설명하고 계산하는가?" },
        "KC-M2_2-2-2-1-02": { jungdanwon: "[2-2] 닮음 도형의 성질", sodanwon: "삼각형의 무게중심", label: "삼각형의 두 변의 중점을 연결한 선분의 성질(2)", desc: "삼각형의 한 변의 중점에서 다른 한 변에 평행하게 그은 선분은 나머지 변의 중점을 지남을 이해하고 있는가?" },
        "KC-M2_2-2-2-1-03": { jungdanwon: "[2-2] 닮음 도형의 성질", sodanwon: "삼각형의 무게중심", label: "삼각형의 중점을 연결한 선분 응용(3) 넓이", desc: "삼각형의 한 중선은 그 삼각형의 넓이를 이등분함을 이용하여 넓이를 구하는가?" },
        "KC-M2_2-2-2-1-04": { jungdanwon: "[2-2] 닮음 도형의 성질", sodanwon: "삼각형의 무게중심", label: "삼각형의 세 변의 중점을 연결한 삼각형(1) 둘레의 길이", desc: "삼각형의 각 변의 중점을 연결하여 만든 삼각형의 둘레의 길이는 원래 삼각형 둘레 길이의 절반임을 알고 계산하는가?" },
        "KC-M2_2-2-2-1-05": { jungdanwon: "[2-2] 닮음 도형의 성질", sodanwon: "삼각형의 무게중심", label: "삼각형의 세 변의 중점을 연결한 삼각형(2) 넓이", desc: "삼각형의 각 변의 중점을 연결하여 만든 삼각형의 넓이는 원래 삼각형 넓이의 1/4임을 알고 계산하는가?" },
        "KC-M2_2-2-2-1-06": { jungdanwon: "[2-2] 닮음 도형의 성질", sodanwon: "삼각형의 무게중심", label: "사각형의 각 변의 중점을 연결하여 만든 사각형", desc: "일반 사각형의 각 변의 중점을 연결하면 평행사변형이 됨을 설명하는가?" },
        "KC-M2_2-2-2-1-07": { jungdanwon: "[2-2] 닮음 도형의 성질", sodanwon: "삼각형의 무게중심", label: "사다리꼴의 두 변의 중점을 연결한 선분의 성질", desc: "사다리꼴의 등변이 아닌 두 변의 중점을 연결한 선분의 길이를 구하는 공식을 활용하는가?" },
        "KC-M2_2-2-2-1-08": { jungdanwon: "[2-2] 닮음 도형의 성질", sodanwon: "삼각형의 무게중심", label: "삼각형의 무게중심(1) △ABC의 무게중심", desc: "삼각형의 무게중심이 세 중선을 각 꼭짓점으로부터 2:1로 나눔을 이용하여 선분의 길이를 구하는가?" },
        "KC-M2_2-2-2-1-09": { jungdanwon: "[2-2] 닮음 도형의 성질", sodanwon: "삼각형의 무게중심", label: "삼각형의 무게중심(2) △ABC, △GBC의 무게중심", desc: "전체 삼각형의 무게중심과 부분 삼각형의 무게중심 사이의 관계를 이용하여 선분의 길이를 구하는가? (예: GG' = (2/9)AD)" },
        "KC-M2_2-2-2-1-10": { jungdanwon: "[2-2] 닮음 도형의 성질", sodanwon: "삼각형의 무게중심", label: "삼각형의 무게중심의 응용(1)", desc: "무게중심 G를 지나고 밑변에 평행한 선분 DE가 있을 때, AD:DB = AE:EC = 2:1임을 이용하는가?" },
        "KC-M2_2-2-2-1-11": { jungdanwon: "[2-2] 닮음 도형의 성질", sodanwon: "삼각형의 무게중심", label: "삼각형의 무게중심의 응용(2)", desc: "무게중심 G를 지나고 밑변에 평행한 선분 DE가 있을 때, DG:BM = AG:AM = 2:3 임을 이용하는가?" },
        "KC-M2_2-2-2-1-12": { jungdanwon: "[2-2] 닮음 도형의 성질", sodanwon: "삼각형의 무게중심", label: "삼각형의 무게중심의 응용(3)", desc: "전체 삼각형의 무게중심 G와, G를 포함하는 부분 삼각형(△GBC)의 무게중심 G'의 관계를 이해하고 있는가?" },
        "KC-M2_2-2-2-1-13": { jungdanwon: "[2-2] 닮음 도형의 성질", sodanwon: "삼각형의 무게중심", label: "삼각형의 무게중심과 넓이의 관계(1) △ABC의 무게중심", desc: "세 중선에 의해 삼각형의 넓이가 6등분됨을 이용하여 각 부분의 넓이를 구하는가?" },
        "KC-M2_2-2-2-1-14": { jungdanwon: "[2-2] 닮음 도형의 성질", sodanwon: "삼각형의 무게중심", label: "삼각형의 무게중심과 넓이의 관계(2) △ABC, △GBC의 무게중심", desc: "전체 삼각형과 무게중심을 꼭짓점으로 하는 부분 삼각형 사이의 넓이 관계를 이용하여 문제를 해결하는가?" },
        "KC-M2_2-2-2-1-15": { jungdanwon: "[2-2] 닮음 도형의 성질", sodanwon: "삼각형의 무게중심", label: "평행사변형에서 삼각형의 무게중심의 응용(1) 길이", desc: "평행사변형의 두 대각선이 서로를 이등분하는 성질을 이용하여 생긴 두 삼각형의 무게중심을 찾고, 대각선 위의 선분 길이 비(1:1:1)를 구하는가?" },
        "KC-M2_2-2-2-1-16": { jungdanwon: "[2-2] 닮음 도형의 성질", sodanwon: "삼각형의 무게중심", label: "평행사변형에서 삼각형의 무게중심의 응용(2) 넓이", desc: "평행사변형을 나눈 각 삼각형의 무게중심과 관련된 넓이 문제를 해결하는가?" },
        "KC-M2_2-2-2-2-01": { jungdanwon: "[2-2] 닮음 도형의 성질", sodanwon: "닮은 도형의 넓이와 부피", label: "닮은 두 평면도형의 넓이의 비(1) 닮음비가 주어진 경우", desc: "닮음비가 m:n일 때 넓이의 비가 m^2:n^2임을 이용하여 한 도형의 넓이가 주어졌을 때 다른 도형의 넓이를 구하는가?" },
        "KC-M2_2-2-2-2-02": { jungdanwon: "[2-2] 닮음 도형의 성질", sodanwon: "닮은 도형의 넓이와 부피", label: "닮은 두 평면도형의 넓이의 비(2) 닮음 도형을 이용하여 도형의 넓이 구하기", desc: "닮음비가 주어지지 않은 도형에서, 길이의 비를 먼저 구한 후 이를 이용해 넓이의 비를 계산하여 문제를 해결하는가?" },
        "KC-M2_2-2-2-2-03": { jungdanwon: "[2-2] 닮음 도형의 성질", sodanwon: "닮은 도형의 넓이와 부피", label: "닮은 두 평면도형의 넓이의 비의 활용", desc: "벽지에 페인트를 칠하는 양이나 음식의 가격 책정 등 실생활 문제에 넓이의 비를 적용하여 해결하는가?" },
        "KC-M2_2-2-2-2-04": { jungdanwon: "[2-2] 닮음 도형의 성질", sodanwon: "닮은 도형의 넓이와 부피", label: "닮은 두 입체도형의 겉넓이의 비", desc: "닮음비가 m:n인 두 입체도형의 겉넓이의 비가 m^2:n^2임을 이용하여 문제를 해결하는가?" },
        "KC-M2_2-2-2-2-05": { jungdanwon: "[2-2] 닮음 도형의 성질", sodanwon: "닮은 도형의 넓이와 부피", label: "닮은 두 입체도형의 겉넓이의 비의 활용", desc: "겉넓이의 비를 포장지 비용 계산 등 실생활 문제에 적용하여 해결하는가?" },
        "KC-M2_2-2-2-2-06": { jungdanwon: "[2-2] 닮음 도형의 성질", sodanwon: "닮은 도형의 넓이와 부피", label: "닮은 두 입체도형의 부피의 비", desc: "닮음비가 m:n인 두 입체도형의 부피의 비가 m^3:n^3임을 이용하여 문제를 해결하는가?" },
        "KC-M2_2-2-2-2-07": { jungdanwon: "[2-2] 닮음 도형의 성질", sodanwon: "닮은 도형의 넓이와 부피", label: "닮은 두 입체도형의 부피의 비의 활용", desc: "그릇에 채운 물의 높이 비를 통해 부피의 비를 구하는 등 실생활 문제에 부피의 비를 적용하는가?" },
        "KC-M2_2-2-2-2-08": { jungdanwon: "[2-2] 닮음 도형의 성질", sodanwon: "닮은 도형의 넓이와 부피", label: "닮음의 활용(1) 높이의 측정", desc: "막대기의 그림자 길이와 실제 건물의 그림자 길이를 비교하는 등, 삼각형의 닮음을 이용해 실제 높이를 간접적으로 측정하는가?" },
        "KC-M2_2-2-2-2-09": { jungdanwon: "[2-2] 닮음 도형의 성질", sodanwon: "닮은 도형의 넓이와 부피", label: "닮음의 활용(2) 축도와 축척", desc: "축척의 의미를 이해하고, 축도에서의 길이와 실제 길이 사이의 관계를 계산하는가?" },
        "KC-M2_2-2-3-1-01": { jungdanwon: "[2-3] 피타고라스 정리", sodanwon: "피타고라스 정리", label: "삼각형의 변의 길이 구하기(1)", desc: "직각삼각형에서 두 변의 길이가 주어졌을 때 피타고라스 정리를 이용하여 나머지 한 변의 길이를 구하는가?" },
        "KC-M2_2-2-3-1-02": { jungdanwon: "[2-3] 피타고라스 정리", sodanwon: "피타고라스 정리", label: "삼각형의 변의 길이 구하기(2)", desc: "도형에 보조선을 그어 직각삼각형을 만든 후, 피타고라스 정리를 이용해 변의 길이를 구하는가?" },
        "KC-M2_2-2-3-1-03": { jungdanwon: "[2-3] 피타고라스 정리", sodanwon: "피타고라스 정리", label: "삼각형의 변의 길이 구하기(3)", desc: "여러 개의 직각삼각형이 이어진 도형에서 피타고라스 정리를 연속적으로 사용하여 변의 길이를 구하는가?" },
        "KC-M2_2-2-3-1-04": { jungdanwon: "[2-3] 피타고라스 정리", sodanwon: "피타고라스 정리", label: "직각삼각형의 닮음과 피타고라스 정리", desc: "직각삼각형의 닮음 관계에서 유도되는 공식들(소 공식 등)과 피타고라스 정리를 함께 활용하여 변의 길이를 구하는가?" },
        "KC-M2_2-2-3-1-05": { jungdanwon: "[2-3] 피타고라스 정리", sodanwon: "피타고라스 정리", label: "사각형에서 피타고라스 정리의 이용(1) 대각선을 그어 푸는 경우", desc: "사각형에 대각선을 그어 만들어지는 직각삼각형에서 피타고라스 정리를 이용하는가?" },
        "KC-M2_2-2-3-1-06": { jungdanwon: "[2-3] 피타고라스 정리", sodanwon: "피타고라스 정리", label: "사각형에서 피타고라스 정리의 이용(2) 수선을 그어 푸는 경우", desc: "사다리꼴 등에서 수선을 그어 직각삼각형을 만든 후 피타고라스 정리를 이용하는가?" },
        "KC-M2_2-2-3-1-07": { jungdanwon: "[2-3] 피타고라스 정리", sodanwon: "피타고라스 정리", label: "직사각형의 대각선의 길이", desc: "직사각형의 가로, 세로 길이를 알 때 대각선의 길이를 피타고라스 정리를 이용하여 구하는가?" },
        "KC-M2_2-2-3-1-08": { jungdanwon: "[2-3] 피타고라스 정리", sodanwon: "피타고라스 정리", label: "이등변삼각형의 높이와 넓이", desc: "이등변삼각형의 꼭지각에서 밑변에 내린 수선이 밑변을 이등분함을 이용하여 높이와 넓이를 구하는가?" },
        "KC-M2_2-2-3-1-09": { jungdanwon: "[2-3] 피타고라스 정리", sodanwon: "피타고라스 정리", label: "피타고라스 정리의 설명(1) 유클리드의 방법", desc: "유클리드의 방법을 이용하여 만들어진 정사각형들의 넓이 관계를 이해하고 설명하는가?" },
        "KC-M2_2-2-3-1-10": { jungdanwon: "[2-3] 피타고라스 정리", sodanwon: "피타고라스 정리", label: "피타고라스 정리의 설명(2) 피타고라스의 방법", desc: "피타고라스의 방법을 이용하여 만들어진 도형들의 넓이 관계를 이해하고 설명하는가?" },
        "KC-M2_2-2-3-1-11": { jungdanwon: "[2-3] 피타고라스 정리", sodanwon: "피타고라스 정리", label: "피타고라스 정리의 설명(3) 가필드의 방법", desc: "가필드의 방법을 이용하여 만들어진 도형들의 넓이 관계를 이해하고 설명하는가?" },
        "KC-M2_2-2-3-1-12": { jungdanwon: "[2-3] 피타고라스 정리", sodanwon: "피타고라스 정리", label: "피타고라스 정리의 설명(4) 바스카라의 방법", desc: "바스카라의 방법을 이용하여 만들어진 도형들의 넓이 관계를 이해하고 설명하는가?" },
        "KC-M2_2-2-3-1-13": { jungdanwon: "[2-3] 피타고라스 정리", sodanwon: "피타고라스 정리", label: "직각삼각형이 되기 위한 조건", desc: "세 변의 길이 a, b, c 사이에 a^2 + b^2 = c^2 관계가 성립하면 직각삼각형임을 설명하는가?" },
        "KC-M2_2-2-3-1-14": { jungdanwon: "[2-3] 피타고라스 정리", sodanwon: "피타고라스 정리", label: "변의 길이에 따른 삼각형의 종류", desc: "가장 긴 변의 제곱과 나머지 두 변의 제곱의 합을 비교하여 예각, 직각, 둔각삼각형을 판별하는가?" },
        "KC-M2_2-2-3-1-15": { jungdanwon: "[2-3] 피타고라스 정리", sodanwon: "피타고라스 정리", label: "각의 크기에 따른 삼각형의 변의 길이", desc: "삼각형의 종류(예각, 둔각)에 대한 조건과 삼각형의 결정조건을 함께 이용하여 미지수 변의 길이 범위를 구하는가?" },
        "KC-M2_2-2-3-2-01": { jungdanwon: "[2-3] 피타고라스 정리", sodanwon: "피타고라스 정리의 활용", label: "피타고라스 정리의 활용(1) 직각삼각형", desc: "직각삼각형 내부의 임의의 두 점을 연결한 선분들의 제곱의 합에 대한 성질(DE^2 + BC^2 = BE^2 + CD^2)을 이용하는가?" },
        "KC-M2_2-2-3-2-02": { jungdanwon: "[2-3] 피타고라스 정리", sodanwon: "피타고라스 정리의 활용", label: "피타고라스 정리의 활용(2) 사각형", desc: "두 대각선이 직교하는 사각형에서 마주 보는 두 변의 길이의 제곱의 합이 같음(AB^2 + CD^2 = BC^2 + DA^2)을 이용하는가?" },
        "KC-M2_2-2-3-2-03": { jungdanwon: "[2-3] 피타고라스 정리", sodanwon: "피타고라스 정리의 활용", label: "피타고라스 정리의 활용(3) 직사각형 내부의 점", desc: "직사각형 내부의 한 점에서 각 꼭짓점에 이르는 거리의 제곱의 합에 대한 성질(PA^2 + PC^2 = PB^2 + PD^2)을 이용하는가?" },
        "KC-M2_2-2-3-2-04": { jungdanwon: "[2-3] 피타고라스 정리", sodanwon: "피타고라스 정리의 활용", label: "피타고라스 정리의 활용(4) 직각삼각형의 세 반원 사이의 관계", desc: "직각삼각형의 각 변을 지름으로 하는 세 반원 사이의 넓이 관계(S1 + S2 = S3)를 이해하고 적용하는가?" },
        "KC-M2_2-2-3-2-05": { jungdanwon: "[2-3] 피타고라스 정리", sodanwon: "피타고라스 정리의 활용", label: "피타고라스 정리의 활용(5) 직각삼각형의 반원이 아닌 세 닮음 도형", desc: "직각삼각형의 각 변을 한 변으로 하는 세 닮은 도형의 넓이 사이의 관계(S1 + S2 = S3)를 이해하고 적용하는가?" },
        "KC-M2_2-2-3-2-06": { jungdanwon: "[2-3] 피타고라스 정리", sodanwon: "피타고라스 정리의 활용", label: "피타고라스 정리의 활용(6) 히포크라테스의 원의 넓이", desc: "히포크라테스의 두 원(초승달 모양)의 넓이의 합이 직각삼각형의 넓이와 같음을 이용하여 문제를 해결하는가?" },
        "KC-M2_2-2-3-2-07": { jungdanwon: "[2-3] 피타고라스 정리", sodanwon: "피타고라스 정리의 활용", label: "피타고라스 나무 문제", desc: "피타고라스 나무에서 특정 부분의 넓이가 다른 부분들의 넓이 합과 같음을 이용하여 문제를 해결하는가?" },
        "KC-M2_2-2-3-2-08": { jungdanwon: "[2-3] 피타고라스 정리", sodanwon: "피타고라스 정리의 활용", label: "종이접기와 피타고라스 정리", desc: "직사각형 등의 종이를 접었을 때 생기는 직각삼각형에서 피타고라스 정리를 활용하여 변의 길이를 구하는가?" },
        "KC-M2_2-2-3-2-09": { jungdanwon: "[2-3] 피타고라스 정리", sodanwon: "피타고라스 정리의 활용", label: "입체도형에서의 피타고라스 정리", desc: "직육면체의 대각선이나 원뿔의 높이 등 입체도형의 요소를 구하기 위해 공간에서 직각삼각형을 찾아내어 피타고라스 정리를 적용하는가?" },
        "KC-M2_2-2-3-2-10": { jungdanwon: "[2-3] 피타고라스 정리", sodanwon: "피타고라스 정리의 활용", label: "좌표평면에서의 최단 거리", desc: "좌표평면 위의 두 점 사이의 거리를 직각삼각형의 빗변으로 보고 피타고라스 정리를 이용해 구하는가?" },
        "KC-M2_2-2-3-2-11": { jungdanwon: "[2-3] 피타고라스 정리", sodanwon: "피타고라스 정리의 활용", label: "각기둥에서의 최단 거리", desc: "각기둥의 전개도를 그려 두 점을 직선으로 연결한 최단 거리를 피타고라스 정리를 이용해 구하는가?" },
        "KC-M2_2-2-3-2-12": { jungdanwon: "[2-3] 피타고라스 정리", sodanwon: "피타고라스 정리의 활용", label: "원기둥에서의 최단 거리", desc: "원기둥의 옆면 전개도인 직사각형에서 두 점을 대각선으로 연결한 최단 거리를 피타고라스 정리를 이용해 구하는가?" },
        "KC-M2_2-3-1-1-01": { jungdanwon: "[3-1] 경우의 수와 확률", sodanwon: "경우의 수", label: "경우의 수", desc: "사건의 의미를 이해하고, 주어진 실험이나 관찰에서 일어날 수 있는 모든 경우의 가짓수를 빠짐없이 설명하는가?" },
        "KC-M2_2-3-1-1-02": { jungdanwon: "[3-1] 경우의 수와 확률", sodanwon: "경우의 수", label: "여러 가지 경우의 수(1) 순서쌍을 이용하여 푸는 경우", desc: "동전이나 주사위를 던지는 경우 등에서 나올 수 있는 모든 결과를 순서쌍을 이용하여 중복과 누락 없이 나열하는가?" },
        "KC-M2_2-3-1-1-03": { jungdanwon: "[3-1] 경우의 수와 확률", sodanwon: "경우의 수", label: "여러 가지 경우의 수(2) 나뭇가지 모양 그림을 이용하여 푸는 경우", desc: "가위바위보나 동전 던지기 같은 복합적인 상황에서 나뭇가지 그림을 이용해 모든 경우의 수를 체계적으로 찾는가?" },
        "KC-M2_2-3-1-1-04": { jungdanwon: "[3-1] 경우의 수와 확률", sodanwon: "경우의 수", label: "돈을 지불하는 경우의 수", desc: "주어진 금액을 여러 단위의 화폐를 사용하여 지불할 때, 액수가 큰 화폐 단위부터 개수를 정하여 모든 지불 경우의 수를 표로 나타내어 구하는가?" },
        "KC-M2_2-3-1-1-05": { jungdanwon: "[3-1] 경우의 수와 확률", sodanwon: "경우의 수", label: "합의 법칙(1) 주사위를 던지는 경우", desc: "두 주사위를 던질 때 나오는 눈의 수의 합이 'a 또는 b'가 되는 경우의 수를 각 경우의 수의 합으로 계산하는가?" },
        "KC-M2_2-3-1-1-06": { jungdanwon: "[3-1] 경우의 수와 확률", sodanwon: "경우의 수", label: "합의 법칙(2) 숫자를 선택하는 경우", desc: "주어진 숫자 범위에서 'a의 배수 또는 b의 배수'를 선택하는 경우의 수를 구할 때, 공배수의 존재 여부에 따라 경우의 수를 올바르게 계산하는가?" },
        "KC-M2_2-3-1-1-07": { jungdanwon: "[3-1] 경우의 수와 확률", sodanwon: "경우의 수", label: "합의 법칙(3) 교통수단이나 길을 선택하는 경우", desc: "여러 지점 사이의 경로가 주어졌을 때, 특정 지점을 거치지 않고 직접 가는 경우와 거쳐서 가는 경우를 합하여 총 경우의 수를 구하는가?" },
        "KC-M2_2-3-1-1-08": { jungdanwon: "[3-1] 경우의 수와 확률", sodanwon: "경우의 수", label: "합의 법칙(4) 물건 또는 사람을 선택하는 경우", desc: "여러 종류의 항목 중에서 한 가지를 선택할 때, 각 종류별 선택 가능한 경우의 수를 더하여 전체 경우의 수를 계산하는가?" },
        "KC-M2_2-3-1-1-09": { jungdanwon: "[3-1] 경우의 수와 확률", sodanwon: "경우의 수", label: "곱의 법칙(1) 주사위를 던지는 경우", desc: "서로 다른 여러 개의 주사위를 동시에 던질 때, 각각의 주사위에서 특정 조건을 만족하는 눈이 나오는 경우의 수를 곱하여 총 경우의 수를 계산하는가?" },
        "KC-M2_2-3-1-1-10": { jungdanwon: "[3-1] 경우의 수와 확률", sodanwon: "경우의 수", label: "곱의 법칙(2) 교통수단이나 길을 선택하는 경우", desc: "A지점에서 B지점을 거쳐 C지점까지 갈 때, 각 구간의 경로의 수를 곱하여 총 경우의 수를 계산하는가?" },
        "KC-M2_2-3-1-1-11": { jungdanwon: "[3-1] 경우의 수와 확률", sodanwon: "경우의 수", label: "곱의 법칙(3) 물건 또는 사람을 선택하는 경우", desc: "서로 다른 종류의 물건이나 사람 그룹에서 각각 하나씩 선택하여 짝을 만드는 경우의 수를 각 그룹의 경우의 수의 곱으로 계산하는가?" },
        "KC-M2_2-3-1-1-12": { jungdanwon: "[3-1] 경우의 수와 확률", sodanwon: "경우의 수", label: "곱의 법칙(4) 신호의 개수", desc: "여러 개의 전구를 켜거나 꺼서 신호를 만들 때, 각 전구가 가질 수 있는 상태의 수를 곱하여 만들 수 있는 모든 신호의 개수를 계산하는가?" },
        "KC-M2_2-3-1-1-13": { jungdanwon: "[3-1] 경우의 수와 확률", sodanwon: "경우의 수", label: "색칠하는 경우의 수", desc: "여러 영역을 색칠할 때, '이웃하는 영역은 다른 색으로'와 같은 조건에 따라 각 영역에 칠할 수 있는 색의 가짓수를 순차적으로 곱하여 모든 경우의 수를 구하는가?" },
        "KC-M2_2-3-1-1-14": { jungdanwon: "[3-1] 경우의 수와 확률", sodanwon: "경우의 수", label: "일렬로 세우는 경우의 수(1)", desc: "n개 중 r개를 뽑아 일렬로 세우는 경우의 수를 n * (n-1) * ... * (n-r+1)로 계산하는가?" },
        "KC-M2_2-3-1-1-15": { jungdanwon: "[3-1] 경우의 수와 확률", sodanwon: "경우의 수", label: "일렬로 세우는 경우의 수(2) 특정한 사람의 자리를 고정하는 경우", desc: "특정 사람의 자리를 먼저 고정한 후, 나머지 사람들을 남은 자리에 일렬로 세우는 경우의 수를 계산하는가?" },
        "KC-M2_2-3-1-1-16": { jungdanwon: "[3-1] 경우의 수와 확률", sodanwon: "경우의 수", label: "일렬로 세우는 경우의 수(3) 이웃하는 경우", desc: "이웃해야 하는 대상을 하나의 묶음으로 취급하여 전체를 배열한 후, 묶음 내부에서 자리를 바꾸는 경우의 수를 곱하여 총 경우의 수를 계산하는가?" },
        "KC-M2_2-3-1-1-17": { jungdanwon: "[3-1] 경우의 수와 확률", sodanwon: "경우의 수", label: "일렬로 세우는 경우의 수(4) 이웃하지 않는 경우", desc: "특정 대상들이 이웃하지 않도록 배열할 때, 나머지 대상을 먼저 배열하고 그 사이사이에 이웃하지 않아야 할 대상들을 배열하는 방식으로 경우의 수를 계산하는가?" },
        "KC-M2_2-3-1-1-18": { jungdanwon: "[3-1] 경우의 수와 확률", sodanwon: "경우의 수", label: "자연수의 개수(1) 0을 포함하지 않는 경우", desc: "0이 아닌 서로 다른 숫자가 적힌 카드 n장 중 2장을 뽑아 두 자리 자연수를 만들 때, 그 개수를 n * (n-1)로 계산하는가?" },
        "KC-M2_2-3-1-1-19": { jungdanwon: "[3-1] 경우의 수와 확률", sodanwon: "경우의 수", label: "자연수의 개수(2) 0을 포함하는 경우", desc: "0을 포함한 서로 다른 n개의 숫자로 두 자리 자연수를 만들 때, 십의 자리에 0이 올 수 없음을 고려하여 경우의 수를 (n-1) * (n-1)로 계산하는가?" },
        "KC-M2_2-3-1-1-20": { jungdanwon: "[3-1] 경우의 수와 확률", sodanwon: "경우의 수", label: "사전식으로 나열하는 경우", desc: "주어진 문자나 숫자를 사전식으로 배열할 때, 각 자리에 올 수 있는 경우를 체계적으로 따져 특정 배열이 몇 번째에 오는지 계산하는가?" },
        "KC-M2_2-3-1-1-21": { jungdanwon: "[3-1] 경우의 수와 확률", sodanwon: "경우의 수", label: "대표를 뽑는 경우의 수(1) 자격이 다른 경우", desc: "n명 중에서 회장, 부회장 등 자격이 다른 r명의 대표를 뽑는 경우의 수를 순서를 고려하여 n * (n-1) * ... * (n-r+1)로 계산하는가?" },
        "KC-M2_2-3-1-1-22": { jungdanwon: "[3-1] 경우의 수와 확률", sodanwon: "경우의 수", label: "대표를 뽑는 경우의 수(2) 자격이 같은 경우", desc: "n명 중에서 자격이 같은 2명의 대표를 뽑는 경우의 수를 (n * (n-1)) / 2로 계산하는가?" },
        "KC-M2_2-3-1-1-23": { jungdanwon: "[3-1] 경우의 수와 확률", sodanwon: "경우의 수", label: "만들 수 있는 선분의 개수(1) 어느 세 점도 한 직선 위에 있지 않은 경우", desc: "어느 세 점도 한 직선 위에 있지 않은 n개의 점으로 만들 수 있는 선분의 개수를 자격이 같은 대표 2명을 뽑는 경우의 수와 같이 (n * (n-1)) / 2로 계산하는가?" },
        "KC-M2_2-3-1-1-24": { jungdanwon: "[3-1] 경우의 수와 확률", sodanwon: "경우의 수", label: "만들 수 있는 선분의 개수(2) 한 직선 위에 있는 점이 함께 주어진 경우", desc: "여러 점 중 일부가 한 직선 위에 있을 때, 모든 점에서 2개를 뽑는 경우의 수에서 한 직선 위의 점들에서 2개를 뽑는 경우의 수를 빼고, 해당 직선 자체를 하나 더하여 총 직선의 개수를 구하는가?" },
        "KC-M2_2-3-1-1-25": { jungdanwon: "[3-1] 경우의 수와 확률", sodanwon: "경우의 수", label: "만들 수 있는 삼각형의 개수(1) 주어진 길이를 이용하여 만들기", desc: "주어진 길이의 선분들로 삼각형을 만들 때, '가장 긴 변의 길이는 나머지 두 변의 길이의 합보다 작다'는 조건을 만족하는 조합의 수를 구하는가?" },
        "KC-M2_2-3-1-1-26": { jungdanwon: "[3-1] 경우의 수와 확률", sodanwon: "경우의 수", label: "만들 수 있는 삼각형의 개수(2) 주어진 점을 연결하여 만들기", desc: "어느 세 점도 한 직선 위에 있지 않은 n개의 점으로 만들 수 있는 삼각형의 개수를 (n * (n-1) * (n-2)) / (3 * 2 * 1)로 계산하는가?" },
        "KC-M2_2-3-1-1-27": { jungdanwon: "[3-1] 경우의 수와 확률", sodanwon: "경우의 수", label: "만들 수 있는 사각형의 개수", desc: "주어진 선분들로 만들 수 있는 사각형의 개수를 구할 때, 가로선 중 2개와 세로선 중 2개를 선택하는 경우의 수를 곱하여 계산하는가?" },
        "KC-M2_2-3-1-1-28": { jungdanwon: "[3-1] 경우의 수와 확률", sodanwon: "경우의 수", label: "최단 경로로 가는 경우의 수", desc: "격자 모양의 경로에서 한 지점에서 다른 지점으로 가는 최단 경로의 수를 각 지점까지 가는 방법의 수를 더해가며 계산하는가?" },
        "KC-M2_2-3-1-1-29": { jungdanwon: "[3-1] 경우의 수와 확률", sodanwon: "경우의 수", label: "방정식을 만족하는 경우의 수", desc: "방정식 ax + by = c를 만족하는 순서쌍 (x, y)의 개수를 구할 때, 계수의 절댓값이 큰 변수부터 수를 대입하여 체계적으로 찾는가?" },
        "KC-M2_2-3-1-1-30": { jungdanwon: "[3-1] 경우의 수와 확률", sodanwon: "경우의 수", label: "부등식을 만족하는 경우의 수", desc: "주어진 부등식을 만족시키는 순서쌍의 개수를 한 변수를 기준으로 가능한 값들을 대입하며 체계적으로 찾는가?" },
        "KC-M2_2-3-1-1-31": { jungdanwon: "[3-1] 경우의 수와 확률", sodanwon: "경우의 수", label: "정해진 규칙에 따라 주어진 결과가 나오는 경우의 수", desc: "특정 규칙이 주어진 상황에서, 나올 수 있는 결과를 만족하는 모든 경우의 수를 논리적으로 추론하여 구하는가?" },
        "KC-M2_2-3-1-1-32": { jungdanwon: "[3-1] 경우의 수와 확률", sodanwon: "경우의 수", label: "대진표를 정하는 경우의 수", desc: "리그전이나 토너먼트 등 주어진 경기 방식에 따라 치러지는 총 경기 수를 각 단계별 경기 수를 합산하여 계산하는가?" },
        "KC-M2_2-3-1-2-01": { jungdanwon: "[3-1] 경우의 수와 확률", sodanwon: "확률의 뜻과 성질", label: "간단한 확률 구하기", desc: "주어진 사건에 대해 일어나는 모든 경우의 수와 해당 사건이 일어나는 경우의 수를 각각 구하고, 그 비율로 확률을 정확히 계산하는가?" },
        "KC-M2_2-3-1-2-02": { jungdanwon: "[3-1] 경우의 수와 확률", sodanwon: "확률의 뜻과 성질", label: "확률 구하기(1) 일렬로 세울 때 확률 구하기", desc: "전체를 일렬로 세우는 모든 경우의 수와 특정 조건을 만족하며 일렬로 세우는 경우의 수를 각각 구하여 확률을 계산하는가?" },
        "KC-M2_2-3-1-2-03": { jungdanwon: "[3-1] 경우의 수와 확률", sodanwon: "확률의 뜻과 성질", label: "확률 구하기(2) 주어진 확률을 만족하는 미정계수 구하기", desc: "전체 경우의 수와 특정 사건의 경우의 수를 미지수를 포함한 식으로 나타내고, 주어진 확률 값을 이용하여 방정식을 세워 미지수의 값을 구하는가?" },
        "KC-M2_2-3-1-2-04": { jungdanwon: "[3-1] 경우의 수와 확률", sodanwon: "확률의 뜻과 성질", label: "확률 구하기(3) 방정식을 만족할 확률", desc: "일어날 수 있는 모든 경우의 수 중에서 주어진 방정식을 만족하는 순서쌍의 개수를 찾아 확률을 계산하는가?" },
        "KC-M2_2-3-1-2-05": { jungdanwon: "[3-1] 경우의 수와 확률", sodanwon: "확률의 뜻과 성질", label: "확률 구하기(4) 부등식을 만족할 확률", desc: "일어날 수 있는 모든 경우의 수 중에서 주어진 부등식을 만족하는 경우의 수를 찾아 확률을 계산하는가?" },
        "KC-M2_2-3-1-2-06": { jungdanwon: "[3-1] 경우의 수와 확률", sodanwon: "확률의 뜻과 성질", label: "확률의 기본 성질", desc: "어떤 사건이 일어날 확률 p의 범위가 0과 1 사이임을 이해하고, 절대로 일어나지 않는 사건(p=0)과 반드시 일어나는 사건(p=1)을 구별하는가?" },
        "KC-M2_2-3-1-3-01": { jungdanwon: "[3-1] 경우의 수와 확률", sodanwon: "확률의 계산", label: "어떤 사건이 일어나지 않을 확률", desc: "특정 사건이 일어나지 않을 확률을 '1 - (그 사건이 일어날 확률)'로 계산하는가?" },
        "KC-M2_2-3-1-3-02": { jungdanwon: "[3-1] 경우의 수와 확률", sodanwon: "확률의 계산", label: "적어도의 조건을 포함하는 확률", desc: "'적어도 하나는 ~일 확률'을 '1 - (모두 ~가 아닐 확률)'을 이용하여 계산하는가?" },
        "KC-M2_2-3-1-3-03": { jungdanwon: "[3-1] 경우의 수와 확률", sodanwon: "확률의 계산", label: "사건 A 또는 사건 B가 일어날 확률", desc: "두 사건이 동시에 일어나지 않을 때, '사건 A 또는 사건 B가 일어날 확률'을 두 사건의 확률의 합으로 계산하는가?" },
        "KC-M2_2-3-1-3-04": { jungdanwon: "[3-1] 경우의 수와 확률", sodanwon: "확률의 계산", label: "두 사건 A와 B가 동시에 일어날 확률", desc: "두 사건이 서로 영향을 끼치지 않을 때, '두 사건이 동시에 일어날 확률'을 두 사건의 확률의 곱으로 계산하는가?" },
        "KC-M2_2-3-1-3-05": { jungdanwon: "[3-1] 경우의 수와 확률", sodanwon: "확률의 계산", label: "두 사건 A, B 중 적어도 하나가 일어날 확률", desc: "두 사건 A, B 중 적어도 하나가 일어날 확률을 '1 - (두 사건 모두 일어나지 않을 확률)'로 계산하는가?" },
        "KC-M2_2-3-1-3-06": { jungdanwon: "[3-1] 경우의 수와 확률", sodanwon: "확률의 계산", label: "확률의 덧셈과 곱셈", desc: "한 사건은 일어나고 다른 사건은 일어나지 않을 확률을 각 확률과 여사건의 확률을 이용하여 곱셈으로 계산하는가?" },
        "KC-M2_2-3-1-3-07": { jungdanwon: "[3-1] 경우의 수와 확률", sodanwon: "확률의 계산", label: "연속하여 꺼내는 경우의 확률 : 꺼낸 것을 다시 넣는 경우", desc: "꺼낸 것을 다시 넣고 연속하여 뽑을 때, 매번의 시행이 독립적이므로 각 시행의 확률을 곱하여 최종 확률을 계산하는가?" },
        "KC-M2_2-3-1-3-08": { jungdanwon: "[3-1] 경우의 수와 확률", sodanwon: "확률의 계산", label: "연속하여 꺼내는 경우의 확률 : 꺼낸 것을 다시 넣지 않는 경우", desc: "꺼낸 것을 다시 넣지 않고 연속하여 뽑을 때, 이전 시행의 결과로 전체 개수가 변하는 것을 고려하여 각 단계의 확률을 계산하고 곱하는가?" },
        "KC-M2_2-3-1-3-09": { jungdanwon: "[3-1] 경우의 수와 확률", sodanwon: "확률의 계산", label: "연속하여 꺼내는 경우의 확률", desc: "한 주머니 또는 두 주머니에서 연속하여 물건을 꺼낼 때, 복원추출과 비복원추출의 차이를 이해하고 상황에 맞게 확률을 계산하는가?" },
        "KC-M2_2-3-1-3-10": { jungdanwon: "[3-1] 경우의 수와 확률", sodanwon: "확률의 계산", label: "게임에서 이길 확률", desc: "특정 회차에서 게임이 끝날 확률을 이전 회차까지는 실패하고 해당 회차에서 성공할 확률의 곱으로 계산하는가?" },
        "KC-M2_2-3-1-3-11": { jungdanwon: "[3-1] 경우의 수와 확률", sodanwon: "확률의 계산", label: "문제를 맞힐 확률", desc: "여러 문제를 풀 때, '모두 맞힐 확률', '모두 틀릴 확률', '특정 문제만 맞힐 확률' 등을 각 문제의 성공 및 실패 확률의 곱으로 계산하는가?" },
        "KC-M2_2-3-1-3-12": { jungdanwon: "[3-1] 경우의 수와 확률", sodanwon: "확률의 계산", label: "명중률", desc: "두 사람이 총을 쏠 때, '모두 맞힐 확률', '한 사람만 맞힐 확률', '모두 못 맞힐 확률'을 각자의 명중률과 실패 확률을 이용하여 계산하는가?" },
        "KC-M2_2-3-1-3-13": { jungdanwon: "[3-1] 경우의 수와 확률", sodanwon: "확률의 계산", label: "가위바위보에서의 확률", desc: "여러 사람이 가위바위보를 할 때, 비길 확률을 '모두 같은 것을 낼 확률'과 '모두 다른 것을 낼 확률'의 합으로 구하고, 승부가 결정될 확률은 1에서 비길 확률을 빼서 계산하는가?" },
        "KC-M2_2-3-1-3-14": { jungdanwon: "[3-1] 경우의 수와 확률", sodanwon: "확률의 계산", label: "수직선에서 위치에 대한 확률", desc: "동전을 던져 수직선 위를 움직이는 상황에서, 최종 위치에 도달하기 위한 앞면과 뒷면의 횟수 조합을 찾고 해당 경우의 수를 전체 경우의 수로 나누어 확률을 계산하는가?" },
        "KC-M2_2-3-1-3-15": { jungdanwon: "[3-1] 경우의 수와 확률", sodanwon: "확률의 계산", label: "도형 또는 좌표평면에서의 확률", desc: "주사위를 던져 나온 눈의 수만큼 도형의 변을 따라 이동할 때, 특정 꼭짓점에 도달할 수 있는 눈의 수의 합의 조합을 찾아 확률을 계산하는가?" },
        "KC-M2_2-3-1-3-16": { jungdanwon: "[3-1] 경우의 수와 확률", sodanwon: "확률의 계산", label: "평면도형에서의 확률(넓이를 이용한 확률)", desc: "과녁과 같은 도형에서 특정 부분에 맞힐 확률을 전체 도형의 넓이에 대한 해당 부분의 넓이의 비율로 계산하는가?" },
        "KC-M2_2-3-1-3-17": { jungdanwon: "[3-1] 경우의 수와 확률", sodanwon: "확률의 계산", label: "대진표에서의 확률", desc: "토너먼트 대진표에서 특정 두 팀이 특정 라운드(예: 결승)에서 만날 확률을, 해당 위치에 배정될 확률과 각 팀이 해당 라운드까지 이길 확률을 모두 곱하여 계산하는가?" }
      };

      // ======== 2. Dynamic Data Calculation Logic ========
      const getScoreColor = (score, type = 'normal') => {
        if (score === null || score === undefined) return 'var(--muted)';

        const colorMap = {
          'var(--green)': 'rgba(40, 167, 69, 0.1)',
          'var(--yellow)': 'rgba(255, 193, 7, 0.1)',
          'var(--red)': 'rgba(220, 53, 69, 0.1)',
          'var(--muted)': 'rgba(108, 117, 125, 0.1)'
        };

        let color;
        if (score >= 85) color = 'var(--green)';
        else if (score >= 70) color = 'var(--yellow)'; // 70~84.9
        else if (score >= 0) color = 'var(--red)'; // 0~69.9
        else color = 'var(--muted)'; // Should not happen for calculated scores

        return type === 'light' ? (colorMap[color] || 'rgba(108, 117, 125, 0.1)') : color;
      };

      // --- Aggregation Structures ---
      const daedanwonMap = {
        "[2] 도형의 닮음": { name: "대단원: [2] 도형의 닮음", problems: new Set(), totalScore: 0, earnedScore: 0, correctCount: 0, totalCount: 0, children: {} },
        "[3] 확률": { name: "대단원: [3] 확률", problems: new Set(), totalScore: 0, earnedScore: 0, correctCount: 0, totalCount: 0, children: {} }
      };

      // Initialize structure based on kcMeta
      Object.keys(kcMeta).forEach(kcCode => {
        const meta = kcMeta[kcCode];
        let daedanwon;
        if (meta.jungdanwon.startsWith("[2-2]") || meta.jungdanwon.startsWith("[2-3]")) {
            daedanwon = daedanwonMap["[2] 도형의 닮음"];
        } else if (meta.jungdanwon.startsWith("[3-1]")) {
            daedanwon = daedanwonMap["[3] 확률"];
        } else {
            console.warn("KC code does not belong to expected Daedanwon:", kcCode);
            return; // Skip if Daedanwon is not found
        }

        if (!daedanwon.children[meta.jungdanwon]) {
          daedanwon.children[meta.jungdanwon] = { name: `중단원: ${meta.jungdanwon}`, problems: new Set(), totalScore: 0, earnedScore: 0, correctCount: 0, totalCount: 0, children: {} };
        }
        const jungdanwon = daedanwon.children[meta.jungdanwon];

        if (!jungdanwon.children[meta.sodanwon]) {
          jungdanwon.children[meta.sodanwon] = { name: `소단원: ${meta.sodanwon}`, problems: new Set(), totalScore: 0, earnedScore: 0, correctCount: 0, totalCount: 0, children: {} };
        }
        // KC nodes are added dynamically during data processing
      });
      // --- End Structure Initialization ---

      // --- Overall Stats Calculation ---
      const totalCorrectProblems = problemRawData.filter(p => p.correct).length;
      const totalProblems = problemRawData.length;
      const correctRate = totalProblems > 0 ? (totalCorrectProblems / totalProblems) * 100 : 0;

      const totalPossibleWeightedScore = problemRawData.reduce((sum, p) => sum + p.difficulty, 0);
      const totalEarnedWeightedScore = problemRawData.reduce((sum, p) => sum + (p.correct ? p.difficulty : 0), 0);
      const weightedAchievement = totalPossibleWeightedScore > 0 ? (totalEarnedWeightedScore / totalPossibleWeightedScore) * 100 : 0;

      const assessedKcCodes = new Set(problemRawData.map(p => p.kc));
      const totalKcCount = Object.keys(kcMeta).length;
      const assessedKcCount = assessedKcCodes.size;
      const coveragePercent = totalKcCount > 0 ? (assessedKcCount / totalKcCount) * 100 : 0;
      // --- End Overall Stats ---

      // --- Build Achievement Tree and Aggregate Scores ---
      function buildAchievementTree() {
        // Process raw data to populate KC nodes
        problemRawData.forEach(p => {
          const meta = kcMeta[p.kc];
          if (!meta) {
              console.warn("Metadata not found for KC:", p.kc);
              return; // Skip if metadata is missing
          }

          let daedanwon;
            if (meta.jungdanwon.startsWith("[2-2]") || meta.jungdanwon.startsWith("[2-3]")) {
                daedanwon = daedanwonMap["[2] 도형의 닮음"];
            } else if (meta.jungdanwon.startsWith("[3-1]")) {
                daedanwon = daedanwonMap["[3] 확률"];
            }
          if (!daedanwon) return; // Should already exist

          const jungdanwon = daedanwon.children[meta.jungdanwon];
          if (!jungdanwon) return; // Should already exist

          const sodanwon = jungdanwon.children[meta.sodanwon];
          if (!sodanwon) return; // Should already exist

          let kcNode = sodanwon.children[p.kc];
          if (!kcNode) {
            kcNode = {
                name: p.kc,
                label: meta.label,
                totalScore: 0,
                earnedScore: 0,
                correctCount: 0, // Initialize counts
                totalCount: 0   // Initialize counts
             };
            sodanwon.children[p.kc] = kcNode;
          }

          // Aggregate at KC level
          kcNode.totalScore += p.difficulty;
          kcNode.earnedScore += p.correct ? p.difficulty : 0;
          kcNode.totalCount++; // Count each problem instance
          if (p.correct) {
              kcNode.correctCount++;
          }
        });

        // Calculate scores and aggregate upwards (KC -> Sodanwon -> Jungdanwon -> Daedanwon)
        Object.values(daedanwonMap).forEach(daedanwon => {
          Object.values(daedanwon.children).forEach(jungdanwon => {
            Object.values(jungdanwon.children).forEach(sodanwon => {
              Object.values(sodanwon.children).forEach(kc => {
                kc.score = kc.totalScore > 0 ? (kc.earnedScore / kc.totalScore) * 100 : null;
                // Aggregate counts and scores to Sodanwon
                sodanwon.totalScore += kc.totalScore;
                sodanwon.earnedScore += kc.earnedScore;
                sodanwon.correctCount += kc.correctCount;
                sodanwon.totalCount += kc.totalCount;
              });
              sodanwon.score = sodanwon.totalScore > 0 ? (sodanwon.earnedScore / sodanwon.totalScore) * 100 : null;
              // Aggregate counts and scores to Jungdanwon
              jungdanwon.totalScore += sodanwon.totalScore;
              jungdanwon.earnedScore += sodanwon.earnedScore;
              jungdanwon.correctCount += sodanwon.correctCount;
              jungdanwon.totalCount += sodanwon.totalCount;
            });
            jungdanwon.score = jungdanwon.totalScore > 0 ? (jungdanwon.earnedScore / jungdanwon.totalScore) * 100 : null;
            // Aggregate counts and scores to Daedanwon
            daedanwon.totalScore += jungdanwon.totalScore;
            daedanwon.earnedScore += jungdanwon.earnedScore;
            daedanwon.correctCount += jungdanwon.correctCount;
            daedanwon.totalCount += jungdanwon.totalCount;
          });
          daedanwon.score = daedanwon.totalScore > 0 ? (daedanwon.earnedScore / daedanwon.totalScore) * 100 : null;
        });

        return Object.values(daedanwonMap).sort((a, b) => a.name.localeCompare(b.name));
      }

      const achievementTree = buildAchievementTree(); // Contains Daedanwon level nodes

      // Collect all assessed KC nodes for action items
      let allKCsInReport = [];
      function collectKCs(unit) {
        // Check if it's a KC node (has label, score, etc. but no 'children' object)
        if (unit.name && unit.name.startsWith('KC-M2_') && !unit.children) {
             allKCsInReport.push(unit);
        }
        // Recursively check children if they exist
        if (unit.children && typeof unit.children === 'object') {
             Object.values(unit.children).forEach(collectKCs);
        }
      }
      achievementTree.forEach(collectKCs);


      // Calculate KC counts per Jungdanwon/Sodanwon after aggregation
      achievementTree.forEach(daedanwon => {
          Object.values(daedanwon.children).forEach(jungdanwon => {
              const jungdanwonName = jungdanwon.name.replace('중단원: ', '');
              const allKcsInJungdanwon = Object.keys(kcMeta).filter(k => kcMeta[k].jungdanwon === jungdanwonName);
              jungdanwon.totalKcs = allKcsInJungdanwon.length;
              jungdanwon.assessedKcs = allKcsInJungdanwon.filter(kc => assessedKcCodes.has(kc)).length;

              Object.values(jungdanwon.children).forEach(sodanwon => {
                  const sodanwonName = sodanwon.name.replace('소단원: ', '');
                  const allKcsInSodanwon = Object.keys(kcMeta).filter(k => kcMeta[k].sodanwon === sodanwonName);
                  sodanwon.totalKcs = allKcsInSodanwon.length;
                  sodanwon.assessedKcs = allKcsInSodanwon.filter(kc => assessedKcCodes.has(kc)).length;
              });
          });
      });
      // --- End Build Tree ---


      // ======== 3. Rendering Functions ========
      function renderSummary() {
        const container = document.getElementById('summary-section');
        if (!container) return;

        // Sort Daedanwons by score
        const sortedUnits = [...achievementTree].filter(u => u.score !== null).sort((a, b) => a.score - b.score);
        const weakest = sortedUnits[0];
        const strongest = sortedUnits[sortedUnits.length - 1];

        container.innerHTML = `
          <div class="card stat-card"><h3>종합 성취도 (가중치)</h3><div class="score" style="color:${getScoreColor(weightedAchievement)}">${weightedAchievement.toFixed(1)}%</div><div class="desc">${totalEarnedWeightedScore.toFixed(1)} / ${totalPossibleWeightedScore.toFixed(1)}점</div></div>
          <div class="card stat-card"><h3>전체 정답률</h3><div class="score" style="color: ${getScoreColor(correctRate)}">${correctRate.toFixed(0)}%</div><div class="desc">${totalCorrectProblems} / ${totalProblems}문항</div></div>
          <div class="card stat-card"><h3>학습 KC 범위</h3><div class="score" style="color: var(--blue);">${coveragePercent.toFixed(0)}%</div><div class="desc">${assessedKcCount} / ${totalKcCount}개</div></div>
          <div class="card stat-card"><h3>최우수 / 최약점 대단원</h3><div class="desc" style="margin-top: 8px;"><span style="color:var(--green)">▲ ${strongest ? strongest.name.replace('대단원: ', '') : 'N/A'} (${strongest && strongest.score !== null ? strongest.score.toFixed(1) : 'N/A'}%)</span><br><span style="color:var(--red)">▼ ${weakest ? weakest.name.replace('대단원: ', '') : 'N/A'} (${weakest && weakest.score !== null ? weakest.score.toFixed(1) : 'N/A'}%)</span></div></div>`;
      }

       function renderTree() {
        const container = document.getElementById('tree-view');
        if (!container) return;
        container.innerHTML = '';

        achievementTree.forEach(daedanwon => {
            const daedanwonElem = document.createElement('div');
            daedanwonElem.className = 'jungdanwon-block card'; // Reuse style
            const scoreColor = getScoreColor(daedanwon.score);
            // Use aggregated counts for Daedanwon
            const problemCounts = `${daedanwon.correctCount}/${daedanwon.totalCount} 문항`;

            daedanwonElem.innerHTML = `
                <div class="jungdanwon-header">
                  <div class="unit-info">
                    <div class="name" style="font-size: 1.25rem; font-weight: 700;">${daedanwon.name.replace('대단원: ', '')}</div>
                    <div class="counts">${problemCounts}</div>
                  </div>
                  <div class="unit-score" style="color:${scoreColor}; font-size: 1.25rem;">${daedanwon.score !== null ? daedanwon.score.toFixed(1) + '%' : '미평가'}</div>
                  <div class="unit-hbar" style="margin-top: 8px;">
                    <div class="hbar"><span style="width:${daedanwon.score || 0}%; background-color:${scoreColor};"></span></div>
                  </div>
                </div>`;

            Object.values(daedanwon.children).sort((a,b) => a.name.localeCompare(b.name)).forEach(jungdanwon => {
                daedanwonElem.appendChild(createJungdanwonElement(jungdanwon));
            });
            container.appendChild(daedanwonElem);
        });
      }

       function createJungdanwonElement(jungdanwonData) {
          const details = document.createElement('details');
          details.style.paddingLeft = "10px"; // Indent Jungdanwon
          const scoreColor = getScoreColor(jungdanwonData.score);
          const displayName = jungdanwonData.name.replace('중단원: ', '');
          const kcCoverage = `<span style="color: var(--blue);">학습 KC: ${jungdanwonData.assessedKcs}/${jungdanwonData.totalKcs}</span>`;
          // Use aggregated counts for Jungdanwon
          const problemCounts = `${jungdanwonData.correctCount}/${jungdanwonData.totalCount} 문항`;

          const summaryContent = `
              <div style="display: flex; justify-content: space-between; align-items: flex-start; width:100%;">
                  <div class="unit-info">
                      <div class="name" style="font-weight: 700;">${displayName}</div>
                      <div class="counts">${kcCoverage} · ${problemCounts}</div>
                  </div>
                  <div class="unit-score" style="color:${scoreColor}">${jungdanwonData.score !== null ? jungdanwonData.score.toFixed(1) + '%' : '미평가'}</div>
              </div>
              <div class="unit-hbar" style="width: 100%;"><div class="hbar"><span style="width:${jungdanwonData.score || 0}%; background-color:${scoreColor};"></span></div></div>
          `;
          const summary = document.createElement('summary');
          summary.innerHTML = summaryContent;
          details.appendChild(summary);

          Object.values(jungdanwonData.children).sort((a,b) => a.name.localeCompare(b.name)).forEach(sodanwon => {
              details.appendChild(createSodanwonElement(sodanwon));
          });
          return details;
      }

      function createSodanwonElement(sodanwonData) {
        const details = document.createElement('details');
        details.style.paddingLeft = "20px"; // Indent Sodanwon further
        const scoreColor = getScoreColor(sodanwonData.score);
        const displayName = sodanwonData.name.replace('소단원: ', '');
        const kcCoverage = `<span style="color: var(--blue);">학습 KC: ${sodanwonData.assessedKcs}/${sodanwonData.totalKcs}</span>`;
        // Use aggregated counts for Sodanwon
        const problemCounts = `${sodanwonData.correctCount}/${sodanwonData.totalCount} 문항`;

        const summaryContent = `
            <div style="display: flex; justify-content: space-between; align-items: flex-start; width:100%;">
                <div class="unit-info">
                    <div class="name" style="font-weight: 600;">${displayName}</div>
                    <div class="counts">${kcCoverage} · ${problemCounts}</div>
                </div>
                <div class="unit-score" style="color:${scoreColor}">${sodanwonData.score !== null ? sodanwonData.score.toFixed(1) + '%' : '미평가'}</div>
            </div>
            <div class="unit-hbar" style="width: 100%;"><div class="hbar"><span style="width:${sodanwonData.score || 0}%; background-color:${scoreColor};"></span></div></div>
        `;
        const summary = document.createElement('summary');
        summary.innerHTML = summaryContent;
        details.appendChild(summary);

        // Assessed KCs within this Sodanwon
        Object.values(sodanwonData.children).sort((a,b) => a.name.localeCompare(b.name)).forEach(kc => {
            details.appendChild(createKcElement(kc, 'assessed'));
        });

        // Unassessed KCs for this Sodanwon
        const allKcsInSodanwon = Object.keys(kcMeta).filter(k => kcMeta[k].sodanwon === displayName);
        const assessedKcsInSodanwon = Object.keys(sodanwonData.children); // KCs that have data
        const unassessed = allKcsInSodanwon.filter(kcCode => !assessedKcsInSodanwon.includes(kcCode));

        unassessed.sort().forEach(kcCode => {
            details.appendChild(createKcElement({ name: kcCode, label: kcMeta[kcCode].label }, 'unassessed'));
        });
        return details;
      }


      function createKcElement(kcData, type) {
          const kcCode = kcData.name;
          const meta = kcMeta[kcCode] || {label: kcData.label || '', desc: ''}; // Ensure meta exists
          const displayName = `<strong>${kcCode}:</strong> <span>${meta.label}</span>`;
          const element = document.createElement('div');
          element.className = 'kc-card';

          if (type === 'assessed') {
              const scoreColor = getScoreColor(kcData.score);
              const scoreText = kcData.score !== null ? `${kcData.score.toFixed(1)}%` : 'N/A';
              const problemCountText = `(${kcData.correctCount}/${kcData.totalCount})`; // Use correct/total counts

              element.innerHTML = `
                  <div class="kc-card-header">
                      <div class="kc-name" title="${kcCode}: ${meta.label}">${displayName}</div>
                      <span class="pill" style="background-color: ${getScoreColor(kcData.score, 'light')}; color: ${scoreColor};">
                          ${scoreText} ${problemCountText}
                      </span>
                  </div>
                  ${kcData.score !== null ? `<div class="unit-hbar" style="margin-top: 4px;"><div class="hbar"><span style="width:${kcData.score}%; background-color:${scoreColor};"></span></div></div>` : ''}`;
          } else {
              // Unassessed KC
              element.innerHTML = `
                  <div class="kc-card-header">
                      <div class="kc-name" title="${kcCode}: ${meta.label}">${displayName}</div>
                      <span class="pill" style="background-color: var(--border); color: var(--muted);">미학습</span>
                  </div>`;
          }
          return element;
      }


      function renderActionItems() {
        const container = document.getElementById('action-items');
        if (!container) return;

        // KCs with cumulative score below 70%
        const weakKCs = allKCsInReport.filter(kc => kc.score !== null && kc.score < 70).sort((a, b) => a.score - b.score);

        let content = '';

        if (weakKCs.length > 0) {
            content += `<h3 style="font-size: 1.1rem; color: var(--red); margin: 8px 0 12px 0;">🚨 보충 학습이 필요한 KC (성취도 70% 미만)</h3><ol style="margin-top:0;">`;
            // Display top 5 weakest KCs
            weakKCs.slice(0, 5).forEach(kc => {
              const kcCode = kc.name;
              const meta = kcMeta[kcCode] || {};
              content += `
                <li>
                  <strong>${kcCode}: ${meta.label || ''}</strong>
                  <div class="sub-title" style="margin-top:-2px;">
                    누적 성취도: <span style="font-weight:700; color:${getScoreColor(kc.score)}">${kc.score.toFixed(1)}%</span> (${kc.correctCount}/${kc.totalCount} 문항)
                  </div>
                  <div class="goal"><strong>학습 목표:</strong> ${meta.desc || '관련 개념 및 문제 풀이 방법을 복습하세요.'}</div>
                </li>`;
            });
            if (weakKCs.length > 5) {
                content += `<li style="list-style: none; margin-bottom: 0; color: var(--muted); font-size: 0.9rem;">...외 ${weakKCs.length - 5}개의 보충 필요 KC가 있습니다. 상세 분석 섹션을 확인하세요.</li>`;
            }
            content += `</ol>`;
        } else if (assessedKcCount < totalKcCount) {
             content += `<h3 style="font-size: 1.1rem; color: var(--green); margin: 8px 0 12px 0;">👍 잘 하고 있습니다!</h3><p style="color:var(--muted); margin-top:12px;">현재까지 학습한 모든 KC의 성취도가 70% 이상입니다. 아직 학습하지 않은 KC에 도전해 보세요.</p>`;
        } else {
             content += `<h3 style="font-size: 1.1rem; color: var(--green); margin: 8px 0 12px 0;">🎉 완벽합니다!</h3><p style="color:var(--muted); margin-top:12px;">모든 KC를 학습했으며, 성취도 70% 이상을 달성했습니다!</p>`;
        }


        // Unassessed KCs
        const unassessedKCs = Object.keys(kcMeta).filter(kcCode => !assessedKcCodes.has(kcCode));
        if (unassessedKCs.length > 0) {
            content += `<h3 style="font-size: 1.1rem; color: var(--blue); margin: 24px 0 12px 0;">🚀 추가 학습을 권장하는 KC (미학습)</h3><ol style="margin-top:0;">`;

            // Group unassessed KCs by Sodanwon
            const unassessedBySodanwon = {};
            unassessedKCs.forEach(kcCode => {
                const meta = kcMeta[kcCode];
                if (!meta) return;
                const sodanwonKey = `${meta.jungdanwon} > ${meta.sodanwon}`; // Use combined key
                if (!unassessedBySodanwon[sodanwonKey]) {
                    unassessedBySodanwon[sodanwonKey] = {sodanwonName: meta.sodanwon, kcs: []};
                }
                unassessedBySodanwon[sodanwonKey].kcs.push(kcCode);
            });

            // Sort Sodanwons and display top ones
            const sortedSodanwonKeys = Object.keys(unassessedBySodanwon).sort();
            sortedSodanwonKeys.slice(0, 3).forEach(sodanwonKey => { // Display first 3 Sodanwons
                const data = unassessedBySodanwon[sodanwonKey];
                content += `<li style="margin-bottom: 12px;"><strong>${data.sodanwonName}</strong><div class="goal" style="padding-top: 12px;">`;
                data.kcs.sort().slice(0, 3).forEach(kcCode => { // Display first 3 KCs per Sodanwon
                    const meta = kcMeta[kcCode];
                    content += `<div style="font-size: 0.9rem; margin-bottom: 8px;" title="${meta.desc || ''}"><strong>${kcCode}:</strong> ${meta.label || ''}</div>`;
                });
                if (data.kcs.length > 3) {
                     content += `<div style="font-size: 0.9rem; margin-bottom: 8px; color: var(--muted);">...외 ${data.kcs.length - 3}개</div>`;
                }
                content += `</div></li>`;
            });
             if (sortedSodanwonKeys.length > 3) {
                content += `<li style="list-style: none; margin-bottom: 0; color: var(--muted); font-size: 0.9rem;">...외 ${sortedSodanwonKeys.length - 3}개의 소단원에 미학습 KC가 있습니다. 상세 분석 섹션을 확인하세요.</li>`;
            }
            content += `</ol>`;
        }

        container.innerHTML = content;
      }

      // ======== 4. Initial Execution ========
      renderSummary();
      renderTree();
      renderActionItems();
    });
  </script>
</body>
</html>
