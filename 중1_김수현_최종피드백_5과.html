<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>중1_김수현 학생 · 내신 학습 지식맵 (2025-09-18)</title>
  <style>
   :root{
   --bg: #f6f7fb; --card:#ffffff; --border:#e6e8ef; --text:#0f172a; --muted:#64748b;
   --indigo:#4f46e5; --green:#16a34a; --yellow:#f59e0b; --red:#ef4444; --blue:#3b82f6;
   --green-100:#dcfce7; --yellow-100:#fef9c3; --red-100:#fee2e2; --gray-100:#f1f5f9; --blue-100:#dbeafe;
   }
   *{box-sizing:border-box} body{margin:0;background:linear-gradient(180deg,#ffffff, var(--bg));color:var(--text);font-family: ui-sans-serif,system-ui,-apple-system,Segoe UI,Roboto,"Noto Sans KR",Apple SD Gothic Neo,Pretendard,Helvetica,Arial,sans-serif}
   .container{max-width:1120px;margin:0 auto;padding:24px}
   .row{display:flex;gap:12px;flex-wrap:wrap;align-items:center;}
   .between{display:flex;align-items:center;justify-content:space-between;gap:12px}
   .card{background:var(--card);border:1px solid var(--border);border-radius:20px;box-shadow:0 4px 12px rgba(15,23,42,.04)}
   .p-16{padding:16px}.p-20{padding:20px}.p-24{padding:24px}
   .btn{border:1px solid var(--border);background:#fff;border-radius:12px;padding:10px 14px;cursor:pointer}
   .btn.active{background:var(--indigo);color:#fff;border-color:var(--indigo)}
   .input{border:1px solid var(--border);background:#fff;border-radius:12px;padding:10px 12px;min-width:260px}
   .grid{display:grid;gap:16px}
   @media(min-width:640px){.grid-2{grid-template-columns:repeat(2,minmax(0,1fr));}}
   @media(min-width:1024px){.grid-3{grid-template-columns:repeat(3,minmax(0,1fr));}}
   .stat{min-width:240px}
   .hbar{height:8px;background:var(--gray-100);border-radius:999px;overflow:hidden}
   .hbar > span{display:block;height:100%}
   .pill{padding:3px 8px;border-radius:999px;font-size:11px;font-weight:700;display:inline-block}
   .legend .pill{border:1px solid var(--border);}
   .muted{color:var(--muted)}
   .title{font-weight:800;letter-spacing:-.3px}
   .sub{font-size:12px}
   .kc-card{display:flex;gap:12px}
   .kc-ico{flex:0 0 auto;width:36px;height:36px;border-radius:12px;background:#f8fafc;display:grid;place-items:center;border:1px solid var(--border)}
   .small{font-size:12px}
   .type-card{display:flex;align-items:flex-start;justify-content:space-between;gap:12px}
   .kbd{font-variant-numeric:tabular-nums}
   .footer{font-size:12px;color:var(--muted);display:flex;gap:8px;align-items:flex-start}
   .feedback-section h3 { font-size: 20px; margin: 0 0 16px 0; display: flex; align-items: center; gap: 8px; }
   .feedback-section h4 { font-size: 16px; margin: 24px 0 8px 0; color: var(--indigo); border-left: 3px solid var(--indigo); padding-left: 8px;}
   .feedback-section .summary { font-size: 14px; color: var(--muted); margin-top: -12px; margin-bottom: 24px; }
   .feedback-section hr { border: 0; border-top: 1px solid var(--border); margin: 24px 0; }
   .feedback-section blockquote { margin: 12px 0; padding: 12px; background-color: var(--gray-100); border-left: 4px solid var(--border); border-radius: 8px; font-size: 13px; }
   .feedback-section .analysis { margin-top: 8px; }
   .feedback-section .analysis strong { color: var(--text); }
   .feedback-section code { background-color: var(--border); padding: 2px 6px; border-radius: 4px; font-size: 12px; color: var(--indigo); }
  </style>
</head>
<body>
  <div class="container">
    <div class="between" style="gap:16px;flex-wrap:wrap">
      <div>
        <div id="mainTitle" class="title" style="font-size:24px">5과. Think like Sherlock Holmes! <span style="color:var(--indigo)">KC & 유형 성취도</span> 대시보드</div>
        <div id="subHeader" class="sub muted">이름: <strong>중1_김수현</strong> · 시험일: <strong>2025-09-18</strong> · 교재: 동아(윤정미)</div>
      </div>
      <div class="row">
        <button id="printBtn" class="btn">내보내기/인쇄</button>
      </div>
    </div>

    <div class="row" style="margin-top:16px;align-items:center">
      <div class="row">
        <button data-view="all" class="btn view-btn active" aria-pressed="true">전체</button>
        <button data-view="core" class="btn view-btn" aria-pressed="false">기반</button>
        <button data-view="dialogue" class="btn view-btn" aria-pressed="false">대화문</button>
        <button data-view="reading" class="btn view-btn" aria-pressed="false">본문</button>
        <button data-view="types" class="btn view-btn" aria-pressed="false">문제 유형</button>
        <button data-view="feedback" class="btn view-btn" aria-pressed="false">피드백</button>
      </div>
      <div style="flex:1"></div>
      <input id="search" class="input" placeholder="KC 코드/이름/설명/유형 검색" />
    </div>

    <div class="grid grid-3" style="margin-top:16px">
      <div class="card p-16 stat">
        <div class="muted small">KC 평균 성취도</div>
        <div id="avgKC" class="title" style="font-size:22px;margin-top:4px">—</div>
        <div class="hbar" style="margin-top:8px"><span id="avgKCBar" style="width:0"></span></div>
      </div>
      <div class="card p-16 stat">
        <div class="muted small">문제 유형 평균 성취도</div>
        <div id="avgType" class="title" style="font-size:22px;margin-top:4px">—</div>
        <div class="hbar" style="margin-top:8px"><span id="avgTypeBar" style="width:0"></span></div>
      </div>
       <div class="card p-16 stat">
        <div class="muted small">문제 정답률</div>
        <div class="row" style="align-items:baseline;gap:6px">
          <div id="avgCorrectRate" class="title" style="font-size:22px;margin-top:4px">—</div>
          <div id="totalCount" class="muted" style="font-weight:600; font-size: 14px;"></div>
        </div>
        <div class="hbar" style="margin-top:8px"><span id="avgCorrectRateBar" style="width:0"></span></div>
      </div>
    </div>

    <div class="legend row card p-16" style="margin-top:16px">
      <div class="muted small">범례:</div>
      <span class="pill" style="background:var(--green-100);color:var(--green)">우수 ≥ 85%</span>
      <span class="pill" style="background:var(--yellow-100);color:var(--yellow)">60–84%</span>
      <span class="pill" style="background:var(--red-100);color:var(--red)">1–59%</span>
      <span class="pill" style="background:#e5e7eb;color:#374151">미평가</span>
    </div>

    <div id="mount"></div>

    <section class="card p-20" style="margin-top:16px" id="focusBox">
      <div class="between">
        <div>
          <div class="title" style="font-size:18px">📌 집중 보완 영역 (상위 3개 KC)</div>
          <div class="sub muted">점수가 낮은 순으로 자동 추천</div>
        </div>
      </div>
      <ol id="focusList" class="small" style="margin-top:8px;padding-left:18px"></ol>
    </section>

    <div class="footer" style="margin-top:16px">
      <span>색상 기준: 🟢 85% 이상, 🟡 60–84%, 🟥 1–59%, 회색=미평가. 검색 또는 상단 버튼으로 뷰를 전환할 수 있습니다. 인쇄 버튼으로 PDF 저장 가능.</span>
    </div>
  </div>

  <script>
  (() => { 'use strict';
    // ======== 데이터 설정 ========
    const studentName = "중1_김수현";
    const examDate = "2025-09-18";

    const kcScores = {
        "KC-5C1": { score: 83.0, correct: 20, total: 24 },
        "KC-5C2": { score: 87.8, correct: 35, total: 40 },
        "KC-5D1": { score: 100.0, correct: 10, total: 10 },
        "KC-5D2": { score: 84.6, correct: 7, total: 8 },
        "KC-5D3": { score: 100.0, correct: 8, total: 8 },
        "KC-5D4": { score: 87.1, correct: 6, total: 7 },
        "KC-5D5": { score: 100.0, correct: 12, total: 12 },
        "KC-5G1": { score: 39.2, correct: 20, total: 45 },
        "KC-5G2": { score: 65.6, correct: 30, total: 43 },
        "KC-5R1": { score: 68.3, correct: 13, total: 21 },
        "KC-5R2": { score: 73.3, correct: 28, total: 41 },
        "KC-5R3": { score: 75.1, correct: 45, total: 63 },
        "KC-5R4": { score: 64.0, correct: 19, total: 34 },
        "KC-5R5": { score: 89.8, correct: 38, total: 46 },
        "KC-5R6": { score: 86.4, correct: 5, total: 6 },
        "KC-5V1": { score: 83.2, correct: 27, total: 35 }
    };

    const typeScores = [
        { code: "111", name: "핵심 내용 파악하기", area: "대화문", score: 93.6, kcs: ["KC-5C1", "KC-5C2", "KC-5D2"], correct: 8, total: 9 },
        { code: "112", name: "세부 내용 파악하기", area: "대화문", score: 100.0, kcs: ["KC-5D3", "KC-5D4"], correct: 6, total: 6 },
        { code: "113", name: "지문 요약하기", area: "대화문", score: 100.0, kcs: ["KC-5D1"], correct: 1, total: 1 },
        { code: "121", name: "문맥 파악하기", area: "대화문", score: 72.7, kcs: ["KC-5C1", "KC-5C2", "KC-5D1", "KC-5D3"], correct: 8, total: 11 },
        { code: "122", name: "순서 배열하기", area: "대화문", score: 89.5, kcs: ["KC-5D5"], correct: 8, total: 9 },
        { code: "124", name: "빈칸 추론하기", area: "대화문", score: 100.0, kcs: ["KC-5C1"], correct: 2, total: 2 },
        { code: "131", name: "의미 파악하기", area: "대화문", score: 100.0, kcs: ["KC-5V1"], correct: 5, total: 5 },
        { code: "132", name: "영영풀이 알기", area: "대화문", score: 40.0, kcs: ["KC-5V1"], correct: 1, total: 4 },
        { code: "141", name: "해석 및 질문에 답하기", area: "대화문", score: 100.0, kcs: ["KC-5C1"], correct: 3, total: 3 },
        { code: "142", name: "영작하기", area: "대화문", score: 100.0, kcs: ["KC-5C2"], correct: 15, total: 15 },
        { code: "241", name: "문장 전환하기", area: "문법/어법", score: 86.7, kcs: ["KC-5G1"], correct: 3, total: 4 },
        { code: "242", name: "영작하기", area: "문법/어법", score: 75.9, kcs: ["KC-5G1", "KC-5G2"], correct: 10, total: 13 },
        { code: "251", name: "옳고 그름 판단하기", area: "문법/어법", score: 43.3, kcs: ["KC-5G1", "KC-5G2", "KC-5R1"], correct: 21, total: 43 },
        { code: "252", name: "쓰임 구분하기", area: "문법/어법", score: 100.0, kcs: ["KC-5G1"], correct: 2, total: 2 },
        { code: "253", name: "빈칸에 적절한 것 고르기", area: "문법/어법", score: 51.8, kcs: ["KC-5G1"], correct: 10, total: 19 },
        { code: "311", name: "핵심 내용 파악하기", area: "본문", score: 88.9, kcs: ["KC-5R1", "KC-5R4"], correct: 10, total: 11 },
        { code: "312", name: "세부 내용 파악하기", area: "본문", score: 60.1, kcs: ["KC-5R2", "KC-5R3", "KC-5R4", "KC-5R5"], correct: 21, total: 32 },
        { code: "313", name: "관련 내용 파악하기", area: "본문", score: 33.3, kcs: ["KC-5R3"], correct: 1, total: 2 },
        { code: "314", name: "지문 요약하기", area: "본문", score: 78.9, kcs: ["KC-5R5", "KC-5R6"], correct: 6, total: 8 },
        { code: "321", name: "문맥 파악하기", area: "본문", score: 88.9, kcs: ["KC-5R3", "KC-5R5"], correct: 8, total: 9 },
        { code: "322", name: "흐름 추론하기", area: "본문", score: 51.0, kcs: ["KC-5R2", "KC-5R3"], correct: 6, total: 11 },
        { code: "323", name: "내용 추론하기", area: "본문", score: 81.8, kcs: ["KC-5R3", "KC-5R4"], correct: 6, total: 7 },
        { code: "324", name: "밑줄 친 부분 추론하기", area: "본문", score: 100.0, kcs: ["KC-5R5"], correct: 7, total: 7 },
        { code: "325", name: "빈칸 추론하기", area: "본문", score: 79.2, kcs: ["KC-5R5"], correct: 5, total: 6 },
        { code: "331", name: "의미 파악하기", area: "본문", score: 77.8, kcs: ["KC-5V1"], correct: 2, total: 3 },
        { code: "332", name: "영영풀이 알기", area: "본문", score: 63.6, kcs: ["KC-5V1"], correct: 3, total: 4 },
        { code: "333", name: "어휘의 관계 및 활용", area: "본문", score: 100.0, kcs: ["KC-5V1"], correct: 1, total: 1 },
        { code: "341", name: "우리말로 표현하기", area: "본문", score: 95.9, kcs: ["KC-5R2", "KC-5R3"], correct: 24, total: 25 },
        { code: "342", name: "영어로 표현하기", area: "본문", score: 81.8, kcs: ["KC-5R4"], correct: 4, total: 5 }
    ];
    
    const totalCorrectAll = typeScores.reduce((sum, t) => sum + (t.correct || 0), 0);
    const totalProblemsAll = typeScores.reduce((sum, t) => sum + (t.total || 0), 0);

    const kcMeta = {
        "KC-5C1": { area: "의사소통", label: "허락 구하기 (May I ~?)", desc: "상대방에게 허락을 구하고 답하는 표현" },
        "KC-5C2": { area: "의사소통", label: "금지하기 (must not / don't)", desc: "강한 금지와 부정명령문 표현" },
        "KC-5G1": { area: "문법", label: "비교급과 최상급", desc: "두 대상 비교(-er than)와 셋 이상 중 최고(the -est)" },
        "KC-5G2": { area: "문법", label: "There is / There are 구문", desc: "존재를 나타내는 There is/are/was/were" },
        "KC-5V1": { area: "어휘", label: "핵심 어휘 활용", desc: "eyewitness, criminal, scene 등 핵심 단어" },
        "KC-5D1": { area: "대화문", label: "금지와 불필요 구분", desc: "must not talk (금지)와 don’t have to (불필요) 차이" },
        "KC-5D2": { area: "대화문", label: "허락 거절", desc: "May I touch ~?에 대한 거절과 금지 이유 설명" },
        "KC-5D3": { area: "대화문", label: "허락과 금지", desc: "May I go ~? 수락과 don't run 금지 명령" },
        "KC-5D4": { area: "대화문", label: "구체적 허락/금지", desc: "음식물 반입 금지와 특정 품목 허용" },
        "KC-5D5": { area: "대화문", label: "메인(박물관 대화)", desc: "사진 촬영 허락과 플래시 사용 금지" },
        "KC-5R1": { area: "본문", label: "사건 개요 파악", desc: "모나리자 케이크 투척 사건의 기본 정보" },
        "KC-5R2": { area: "본문", label: "목격자 1 (Ann) 진술", desc: "범인의 키에 대한 단서(taller than me) 파악" },
        "KC-5R3": { area: "본문", label: "목격자 2 (Carlos) 진술", desc: "가발 쓴 젊은 남자, 속도 단서(faster than me) 파악" },
        "KC-5R4": { area: "본문", label: "목격자 3 (Diego) 진술", desc: "현장 상황 묘사와 케이크 상자 단서 파악" },
        "KC-5R5": { area: "본문", label: "목격자 4 (Camila) 진술", desc: "범인의 특징(영어, 파란 눈, 작은 케이크) 파악" },
        "KC-5R6": { area: "본문", label: "종합적 추론", desc: "모든 진술을 종합하여 용의자 목록에서 범인 찾기" }
    };
    const groups = [
      { id: "core", title: "A. 기반 지식", subtitle: "의사소통·문법·어휘 기반", items:["KC-5C1","KC-5C2","KC-5G1","KC-5G2","KC-5V1"] },
      { id: "dialogue", title: "B-1. 적용 · 대화문", subtitle: "실제 대화 상황 이해", items:["KC-5D1","KC-5D2","KC-5D3","KC-5D4","KC-5D5"] },
      { id: "reading", title: "B-2. 적용 · 본문", subtitle: "Think like Sherlock Holmes!", items:["KC-5R1","KC-5R2","KC-5R3","KC-5R4", "KC-5R5", "KC-5R6"] }
    ];
    
    function getFeedbackHTML() { 
      return `
      <h3>📊 상세 분석 및 맞춤 피드백</h3>
      <hr>
      <h4>✍️ 문법: 규칙은 알지만, 적용은 어려운 상태</h4>
      <p class="summary">
        <strong>핵심 약점: 비교급/최상급(KC-5G1, 성취도 39.2%)</strong>과 <strong>There is/are 구문(KC-5G2, 성취도 65.6%)</strong> 같은 핵심 문법 지식을 실제 문장에서 가려내는 능력이 부족합니다. 특히 여러 문법 규칙이 섞여 있는 복합 문제에서 정답을 찾는 데 어려움을 겪으며, 이는 <strong>문법성 판단 유형(유형 251)</strong>의 낮은 정답률(<strong>43.3%</strong>)로 이어지고 있습니다.
      </p>
      <blockquote>
        <p><strong>대표 문제 예시 (Final모의고사 27번)</strong></p>
        <p><strong>[문제]</strong> 27. 다음 (A)~(E) 문장에 대해 어법상 올바르게 설명한 학생은 모두 몇 명인가?<br>
        (A) She sings best than her classmates. (B) My brother is quieter than me at home. (C) He is the fatest cat in the neighborhood. (D) The exam was difficulter than I expected. (E) That was most exciting moment of the game.</p>
        <p><strong>[학생들의 설명]</strong><br>
        - 수연: (A)는 than이 사용된 비교급 문장이므로 ... best를 ... better로 고쳐야 해.<br>
        - 민형: (B)는 ... 형용사 quiet가 비교급으로 활용된 어법상 옳은 문장이야.<br>
        - 하민: (C)에서 the fatest는 형용사 fat의 최상급으로 어법상 옳아.<br>
        - 현아: (D)에서 difficult는 3음절 이상의 단어이므로 difficulter more difficult로 고쳐야 해.<br>
        - 인규: (E)는 exciting은 3음절 이상의 단어이므로 최상급 앞에 most가 붙은 어법상 옳은 문장이야.</p>
        <p><strong>[선택지]</strong> ① 1명 ② (정답) 2명 ③ 3명 ④ 4명 ⑤ 5명</p>
        <p>➡️ <strong>학생 답안: ④번 (4명)</strong></p>
      </blockquote>
      <p class="analysis"><strong>분석:</strong> 정답은 ②번(수연, 현아)이지만, 학생은 ④번(4명)을 골랐습니다. 이는 수연, 현아의 설명이 옳다는 것은 파악했지만, <strong>민형과 인규의 설명까지 맞다고 판단</strong>한 아쉬운 실수입니다.<br>
      - <strong>민형</strong>의 설명은 맞습니다. <code>quieter</code>는 <code>quiet</code>의 올바른 비교급 형태입니다.<br>
      - 하지만 <strong>인규</strong>의 설명은 결정적인 부분을 놓쳤습니다. <code>exciting</code>의 최상급이 <code>most exciting</code>인 것은 맞지만, 최상급 앞에는 <strong>반드시 정관사 'the'</strong>가 붙어야 합니다. (E) 문장에는 'the'가 빠져 있으므로 어법상 틀렸고, 따라서 인규의 설명("어법상 옳은 문장이야")도 틀렸습니다. 이처럼 <strong>최상급 앞의 'the'</strong> 와 같이 사소해 보이지만 핵심적인 규칙을 끝까지 확인하는 연습이 필요합니다.
      </p>
      <hr>
      <h4>📚 본문 독해: '핵심 단서'를 놓치는 상태</h4>
      <p class="summary">
        글의 전반적인 내용은 이해하지만, 여러 목격자의 진술처럼 <strong>분산된 정보를 종합하여 답을 찾아야 할 때</strong> 결정적인 단서를 놓치는 경향이 있습니다. 특히 <strong>내용 일치/불일치(유형 312, 성취도 60.1%)</strong>와 <strong>글의 순서 배열(유형 322, 성취도 51.0%)</strong> 유형에서 약점을 보입니다.
      </p>
      <blockquote>
        <p><strong>대표 문제 예시 (Final모의고사 20번)</strong></p>
        <p><strong>[지문]</strong> (Carlos Diaz의 진술) ... the old man was not old. He was a young man with long brown hair. (Diego Perez의 진술) ... I found a cake box next to the wheelchair. The box was from Camila's Bakery. (Camila Santos의 진술) ... Last Friday, a young man came in. I spoke to him in Spanish, but he didn't understand me. He spoke only English.</p>
        <p><strong>[문제]</strong> 20. 다음 글을 읽고 답할 수 있는 질문은 &lt;보기&gt;에서 몇 개인가?<br>
        &lt;보기&gt; (a) Who found the cake box? (b) Where is Camila's bakery? (c) Where was the wheelchair? (d) What was the color of the wig? (e) How old was the old man actually?</p>
        <p><strong>[선택지]</strong> ① 1개 ② 2개 ③ (정답) 3개 ④ 4개 ⑤ 5개</p>
        <p>➡️ <strong>학생 답안: ④번 (4개)</strong></p>
      </blockquote>
      <p class="analysis"><strong>분석:</strong> 정답은 ③번(3개)이지만, 학생은 ④번(4개)을 선택했습니다. 이는 답할 수 있는 질문 3개((a), (c), (d)) 외에 <strong>답할 수 없는 질문 하나를 더 가능하다고 판단</strong>한 것입니다.<br>
      - <strong>(b) 카밀라 빵집의 위치</strong>: 본문에는 케이크 상자가 'Camila's Bakery'에서 왔다는 정보만 있을 뿐, 그 빵집이 <strong>어디에 있는지</strong>는 전혀 언급되지 않았습니다.<br>
      - <strong>(e) 노인의 실제 나이</strong>: 본문에서 'a young man'이라고 했을 뿐, <strong>정확히 몇 살인지</strong>는 알 수 없습니다.<br>
      아마도 (b) 또는 (e)에 대한 정보가 글 어딘가에 있을 것이라고 짐작하고 넘어간 것으로 보입니다. 독해 문제에서는 <strong>지문에 명시된 사실(fact)만을 근거</strong>로 답을 골라야 합니다. 글에 없는 내용을 추측하거나 섣불리 판단하지 않도록 주의해야 합니다.
      </p>
      <hr>
      <h4>📖 어휘: '정확한 뜻' 파악 능력 부족</h4>
      <p class="summary">
        단어의 대략적인 의미는 알지만, <strong>영영풀이(유형 132, 성취도 40.0%)</strong>처럼 정확한 정의를 묻는 문제에 약한 모습을 보입니다. 이는 단어를 암기할 때 유의어나 문맥 속 의미에만 의존하고, 그 단어가 가진 핵심적인 정의를 깊이 있게 학습하지 않았다는 의미일 수 있습니다.
      </p>
      <blockquote>
        <p><strong>대표 문제 예시 (Final모의고사 11번)</strong></p>
        <p><strong>[문제]</strong> 11. 다음 중 단어와 영영풀이의 연결이 잘못된 것은?</p>
        <p><strong>[선택지]</strong><br>
        ① crime: an action that the law does not allow<br>
        ② rule: a statement of what you can or cannot do<br>
        ③ criminal: a person who does something against the law<br>
        ④ (정답) run: to leave a place or person secretly and suddenly<br>
        ⑤ explain: to tell someone about something so that he or she can understand it</p>
        <p>➡️ <strong>학생 답안: ②번</strong></p>
      </blockquote>
      <p class="analysis"><strong>분석:</strong> 정답은 ④번이지만, 학생은 ②번을 골랐습니다. ②번 <code>rule</code>(규칙)의 영영풀이는 '무엇을 할 수 있고 없는지에 대한 진술'로 올바르게 연결되었습니다.<br>
      학생이 놓친 <strong>④번</strong>이 틀린 이유는 다음과 같습니다.<br>
      - 영영풀이 'to leave a place or person secretly and suddenly'는 '장소나 사람을 몰래 갑자기 떠나다'라는 의미로, 이는 단순히 '달리다'를 뜻하는 <strong>run</strong>이 아니라 <strong>'도망치다'라는 뜻의 'run away'</strong>에 대한 설명입니다. 본문에도 등장하는 핵심 표현인 만큼, 두 단어의 미묘한 의미 차이를 정확히 구분하는 것이 중요합니다.
      </p>
      `; 
    }

    // ======== 렌더링 로직 ========
    const mount = document.getElementById('mount');
    const searchEl = document.getElementById('search');
    const focusBox = document.getElementById('focusBox');
    let currentView = 'all';

    const thresholds = { excellent:85, ok:60 };
    const clamp = (n) => Math.max(0, Math.min(100, Number(n||0)));
    
    // A 규칙: 항상 소수 1자리(100도 100.0%)
    function scoreLabel(v){ 
      if(v==null) return '미평가'; 
      const n = Number(v); 
      return n.toFixed(1) + '%'; 
    }
    function average(nums){ const vals = nums.filter(v => v!=null && !Number.isNaN(Number(v))); if(!vals.length) return null; return vals.reduce((a,b)=>a+Number(b),0)/vals.length; }
    function barColor(v){ if(v==null) return '#e5e7eb'; if(v>=thresholds.excellent) return 'var(--green)'; if(v>=thresholds.ok) return 'var(--yellow)'; return 'var(--red)'; }
    function statusColor(v){ if(v==null) return 'background:#e5e7eb;color:#374151'; if(v>=thresholds.excellent) return 'background:var(--green-100);color:var(--green)'; if(v>=thresholds.ok) return 'background:var(--yellow-100);color:var(--yellow)'; return 'background:var(--red-100);color:var(--red)';}

    function KCCard(id){
      const m = kcMeta[id]||{}; const v = kcScores[id] || {score:null, correct:0, total:0};
      const el = document.createElement('div');
      el.className = 'card p-16'; el.style.borderColor = '#e5e7eb';
      el.innerHTML = `
        <div class="kc-card">
          <div class="kc-ico">${m.area==='의사소통'?'💬':m.area==='문법'?'✍️':m.area==='어휘'?'🔤':m.area==='대화문'?'💬':'📖'}</div>
          <div style="flex:1;min-width:0">
            <div class="row" style="align-items:center;gap:6px;flex-wrap:wrap">
              <span class="small" style="font-weight:700">${id}</span>
              <span class="pill" style="${statusColor(v.score)}">${scoreLabel(v.score)}</span>
            </div>
            <div class="row between">
                <div class="small" style="font-weight:700;margin-top:4px">${m.label||''}</div>
                <div class="small muted" style="margin-top:4px">(${v.correct}/${v.total})</div>
            </div>
            <div class="small muted" style="margin-top:2px">${m.desc||''}</div>
            <div class="hbar" style="margin-top:8px"><span style="width:${clamp(v.score||0)}%; background:${barColor(v.score)}"></span></div>
          </div>
        </div>
      `;
      return el;
    }

    function TypeCard(t){
      const el = document.createElement('div');
      el.className = 'card p-16';
      const related = (t.kcs||[]).map(k=>`${k} (${scoreLabel((kcScores[k]||{}).score)})`).join(' · ');
      el.innerHTML = `
        <div class="type-card">
          <div style="min-width:0">
            <div class="row" style="gap:6px;flex-wrap:wrap">
              <span class="small" style="font-weight:700">${t.name}</span>
              <span class="small muted">[${t.code}]</span>
              <span class="pill" style="background:#f3f4f6;color:#374151">${t.area}</span>
            </div>
            <div class="small muted" style="margin-top:4px">(${t.correct}/${t.total})</div>
            <div class="small muted" style="margin-top:4px">연계 KC: ${related}</div>
          </div>
          <div style="text-align:right;min-width:120px;flex-shrink:0;">
            <div style="font-weight:700">${scoreLabel(t.score)}</div>
            <div class="hbar" style="margin-top:6px"><span style="width:${clamp(t.score||0)}%; background:${barColor(t.score)}"></span></div>
          </div>
        </div>
      `;
      return el;
    }
    
    function renderFocus(){
      const list = document.getElementById('focusList');
      if (!list) return;
      const entries = Object.entries(kcScores)
        .filter(([k,v])=>v.score!=null && v.score < thresholds.excellent)
        .sort((a,b)=> (a[1].score-b[1].score) || (String((kcMeta[a[0]]||{}).area) > String((kcMeta[b[0]]||{}).area) ? 1 : -1))
        .slice(0,3);

      list.innerHTML = entries.map(([k,v])=>{
        const m = kcMeta[k]||{};
        return `<li style="margin:6px 0"><strong>${k}</strong> (${m.label||''}) — <span class="pill" style="${statusColor(v.score)}">${scoreLabel(v.score)}</span></li>`;
      }).join('') || '<li class="muted">집중 보완이 필요한 영역이 없습니다. 잘하고 있어요!</li>';
    }

    function render(){
        const q = (searchEl.value||'').trim().toLowerCase();
        mount.innerHTML = '';
        focusBox.style.display = currentView === 'feedback' ? 'none' : 'block';

        ['core','dialogue','reading'].forEach(id=>{
            if(!(currentView==='all' || currentView===id)) return;
            const g = groups.find(x=>x.id===id);
            if (!g) return;
            const items = g.items.filter(k=>{
                if(!q) return true;
                const m = kcMeta[k]||{};
                return k.toLowerCase().includes(q) || (m.label||'').toLowerCase().includes(q) || (m.desc||'').toLowerCase().includes(q) || (m.area||'').toLowerCase().includes(q);
            });
            if(!items.length) return;

            const sec = document.createElement('section');
            sec.className = 'card p-20'; sec.style.marginTop = '16px';
            const secTitle = id==='core'?'🧩 '+g.title : (id==='dialogue'?'💬 '+g.title : '📖 '+g.title);
            sec.innerHTML = `<div class="between"><div><div class="title" style="font-size:18px">${secTitle}</div><div class="sub muted">${g.subtitle}</div></div></div>`;
            const grid = document.createElement('div');
            grid.className = 'grid grid-2 grid-3'; grid.style.marginTop = '12px';
            items.forEach(k => grid.appendChild(KCCard(k)));
            sec.appendChild(grid);
            mount.appendChild(sec);
        });

        if(currentView==='all' || currentView==='types'){
            const filteredTypes = typeScores.filter(t=>{
                if(!q) return true;
                return (t.name+t.code+t.area+(t.kcs||[]).join(',')).toLowerCase().includes(q);
            });
            if(filteredTypes.length){
                const sec = document.createElement('section');
                sec.className = 'card p-20'; sec.style.marginTop = '16px';
                sec.innerHTML = `<div class="between"><div><div class="title" style="font-size:18px">📝 문제 유형 성취도</div><div class="sub muted">총 ${totalProblemsAll}문제 중 ${totalCorrectAll}문제 정답</div></div></div>`;
                const grid = document.createElement('div');
                grid.className = 'grid grid-2'; grid.style.marginTop = '12px';
                filteredTypes.forEach(t => grid.appendChild(TypeCard(t)));
                sec.appendChild(grid);
                mount.appendChild(sec);
            }
        }

        if(currentView==='all' || currentView==='feedback'){
            const sec = document.createElement('section');
            sec.className = 'card p-24 feedback-section'; sec.style.marginTop = '16px';
            sec.innerHTML = getFeedbackHTML();
            mount.appendChild(sec);
        }
        
        const avgKCVal = average(Object.values(kcScores).map(k => k.score));
        document.getElementById('avgKC').textContent = scoreLabel(avgKCVal);
        document.getElementById('avgKCBar').style.width = clamp(avgKCVal) + '%';
        document.getElementById('avgKCBar').style.background = barColor(avgKCVal);

        const avgTypeVal = average(typeScores.map(t => t.score));
        document.getElementById('avgType').textContent = scoreLabel(avgTypeVal);
        document.getElementById('avgTypeBar').style.width = clamp(avgTypeVal) + '%';
        document.getElementById('avgTypeBar').style.background = barColor(avgTypeVal);
        
        const correctRateVal = totalProblemsAll > 0 ? (totalCorrectAll / totalProblemsAll) * 100 : null;
        document.getElementById('avgCorrectRate').textContent = scoreLabel(correctRateVal);
        document.getElementById('totalCount').textContent = `(${totalCorrectAll}/${totalProblemsAll})`;
        const correctRateBar = document.getElementById('avgCorrectRateBar');
        if (correctRateBar) {
            correctRateBar.style.width = clamp(correctRateVal) + '%';
            correctRateBar.style.background = barColor(correctRateVal);
        }
        renderFocus();
    }
    
    function init() {
        document.getElementById('printBtn').addEventListener('click', () => window.print());
        document.body.addEventListener('click', (e) => {
            const btn = e.target.closest('.view-btn');
            if(!btn) return;
            document.querySelectorAll('.view-btn').forEach(b => {
                b.classList.remove('active');
                b.setAttribute('aria-pressed', 'false');
            });
            btn.classList.add('active');
            btn.setAttribute('aria-pressed', 'true');
            currentView = btn.dataset.view || 'all';
            render();
        });
        searchEl.addEventListener('input', render);
        render();
    }

    document.addEventListener('DOMContentLoaded', init);
  })();
  </script>
</body>
</html>