<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>중3 최서윤 학생 · 내신 학습 지식맵 (2025-09-01)</title>
  <style>
    :root{
      --bg: #f6f7fb; --card:#ffffff; --border:#e6e8ef; --text:#0f172a; --muted:#64748b;
      --indigo:#4f46e5; --green:#16a34a; --yellow:#f59e0b; --red:#ef4444;
      --green-100:#dcfce7; --yellow-100:#fef9c3; --red-100:#fee2e2; --gray-100:#f1f5f9;
    }
    *{box-sizing:border-box} body{margin:0;background:linear-gradient(180deg,#ffffff, var(--bg));color:var(--text);font-family: ui-sans-serif,system-ui,-apple-system,Segoe UI,Roboto,"Noto Sans KR",Apple SD Gothic Neo,Pretendard,Helvetica,Arial,sans-serif}
    .container{max-width:1120px;margin:0 auto;padding:24px}
    .row{display:flex;gap:12px;flex-wrap:wrap}
    .between{display:flex;align-items:center;justify-content:space-between;gap:12px}
    .card{background:var(--card);border:1px solid var(--border);border-radius:20px;box-shadow:0 4px 12px rgba(15,23,42,.04)}
    .p-16{padding:16px}.p-20{padding:20px}.p-24{padding:24px}
    .btn{border:1px solid var(--border);background:#fff;border-radius:12px;padding:10px 14px;cursor:pointer}
    .btn.active{background:var(--indigo);color:#fff;border-color:var(--indigo)}
    .input{border:1px solid var(--border);background:#fff;border-radius:12px;padding:10px 12px;min-width:260px}
    .grid{display:grid;gap:16px}
    @media(min-width:640px){.grid-2{grid-template-columns:repeat(2,minmax(0,1fr));}}
    @media(min-width:768px){.grid-3{grid-template-columns:repeat(3,minmax(0,1fr));}}
    .stat{min-width:240px}
    .hbar{height:8px;background:var(--gray-100);border-radius:999px;overflow:hidden}
    .hbar > span{display:block;height:100%}
    .pill{padding:3px 8px;border-radius:999px;font-size:11px;font-weight:700;display:inline-block}
    .legend .pill{border:1px solid var(--border);}
    .muted{color:var(--muted)}
    .title{font-weight:800;letter-spacing:-.3px}
    .sub{font-size:12px}
    .kc-card{display:flex;gap:12px}
    .kc-ico{flex:0 0 auto;width:36px;height:36px;border-radius:12px;background:#f8fafc;display:grid;place-items:center;border:1px solid var(--border)}
    .small{font-size:12px}
    .type-card{display:flex;align-items:flex-start;justify-content:space-between;gap:12px}
    .kbd{font-variant-numeric:tabular-nums}
    .footer{font-size:12px;color:var(--muted);display:flex;gap:8px;align-items:flex-start}

    /* 피드백 스타일 */
    .feedback-section h3 { font-size: 20px; margin: 0 0 16px 0; display: flex; align-items: center; gap: 8px; }
    .feedback-section h4 { font-size: 16px; margin: 24px 0 8px 0; color: var(--indigo); border-left: 3px solid var(--indigo); padding-left: 8px;}
    .feedback-section .summary { font-size: 14px; color: var(--muted); margin-top: -12px; margin-bottom: 24px; }
    .feedback-section hr { border: 0; border-top: 1px solid var(--border); margin: 24px 0; }
    .feedback-section blockquote { margin: 12px 0; padding: 12px; background-color: var(--gray-100); border-left: 4px solid var(--border); border-radius: 8px; font-size: 13px; }
    .feedback-section .analysis { margin-top: 8px; }
    .feedback-section .analysis strong { color: var(--text); }
  </style>
</head>
<body>
  <div class="container">
    <div class="between" style="gap:16px;flex-wrap:wrap">
      <div>
        <div class="title" style="font-size:24px">중3 6과 <span style="color:var(--indigo)">KC & 유형 성취도</span> 대시보드</div>
        <div class="sub muted">학생: <strong>최서윤 학생</strong> · 시험일: <strong>2025-09-01</strong> · 교재: 동아(이병민)</div>
      </div>
      <div class="row">
        <button id="printBtn" class="btn">내보내기/인쇄</button>
      </div>
    </div>

    <div class="row" style="margin-top:16px;align-items:center">
      <div class="row">
        <button data-view="all" class="btn view-btn active">전체</button>
        <button data-view="core" class="btn view-btn">기반</button>
        <button data-view="dialogue" class="btn view-btn">대화문</button>
        <button data-view="reading" class="btn view-btn">본문</button>
        <button data-view="types" class="btn view-btn">문제 유형</button>
        <button data-view="feedback" class="btn view-btn">피드백</button>
      </div>
      <div style="flex:1"></div>
      <input id="search" class="input" placeholder="KC 코드/이름/설명/유형 검색" />
    </div>

    <div class="grid grid-2" style="margin-top:16px">
      <div class="card p-16 stat">
        <div class="muted small">KC 평균 성취도</div>
        <div id="avgKC" class="title" style="font-size:22px;margin-top:4px">—</div>
        <div class="hbar" style="margin-top:8px"><span id="avgKCBar" style="width:0"></span></div>
      </div>
      <div class="card p-16 stat">
        <div class="muted small">문제 유형 평균 성취도</div>
        <div id="avgType" class="title" style="font-size:22px;margin-top:4px">—</div>
        <div class="hbar" style="margin-top:8px"><span id="avgTypeBar" style="width:0"></span></div>
      </div>
    </div>

    <div class="legend row card p-16" style="margin-top:16px">
      <div class="muted small">범례:</div>
      <span class="pill" style="background:var(--green-100);color:var(--green)">우수 ≥ 85%</span>
      <span class="pill" style="background:var(--yellow-100);color:var(--yellow)">60–84%</span>
      <span class="pill" style="background:var(--red-100);color:var(--red)">1–59%</span>
      <span class="pill" style="background:#e5e7eb;color:#374151">미평가</span>
    </div>

    <div id="mount"></div>

    <section class="card p-20" style="margin-top:16px" id="focusBox">
      <div class="between">
        <div>
          <div class="title" style="font-size:18px">📌 집중 보완 영역 (상위 3개 KC)</div>
          <div class="sub muted">점수가 낮은 순으로 자동 추천</div>
        </div>
      </div>
      <ol id="focusList" class="small" style="margin-top:8px;padding-left:18px"></ol>
    </section>

    <div class="footer" style="margin-top:16px">
      <span>색상 기준: 🟢 85% 이상, 🟡 60–84%, 🟥 1–59%, 회색=미평가. 검색 또는 상단 버튼으로 뷰를 전환할 수 있습니다. 인쇄 버튼으로 PDF 저장 가능.</span>
    </div>
  </div>

  <script>
    // ======== 데이터 설정 ========
    const studentName = "최서윤";
    const examDate = "2025-09-01";

    // KC 메타(예시)
    const kcMeta = {
      "KC-6C1": { area: "의사소통", label: "감사하기", desc: "Thank you for ~" },
      "KC-6C2": { area: "의사소통", label: "금지하기", desc: "You’re not allowed to ~" },
      "KC-6G1": { area: "문법", label: "목적을 나타내는 so that", desc: "'~하기 위해서', '~하도록' 목적 표현" },
      "KC-6G2": { area: "문법", label: "형용사/부사 + enough to", desc: "'~할 만큼 충분히 ...하다' 표현" },
      "KC-6V1": { area: "어휘", label: "예술/건축 어휘", desc: "imitate, inspiration, architect 등" },
      "KC-6D1": { area: "대화문", label: "여행 안내 감사", desc: "Thank you for showing me around." },
      "KC-6D2": { area: "대화문", label: "생일 초대 감사", desc: "Thank you for inviting me." },
      "KC-6D3": { area: "대화문", label: "콘서트 예매 규칙 확인", desc: "not allowed to bring children under 8" },
      "KC-6D6": { area: "대화문", label: "실내 반입 금지 안내", desc: "not allowed to bring your umbrella inside" },
      "KC-6D9": { area: "대화문", label: "미술관 관람 규칙", desc: "not allowed to touch them" },
      "KC-6R1": { area: "본문", label: "자연을 모방하는 예술", desc: "달걀 예시, strong enough to 구문" },
      "KC-6R2": { area: "본문", label: "사그라다 파밀리아", desc: "가우디, 나무 형태의 기둥" },
      "KC-6R3": { area: "본문", label: "시드니 오페라 하우스", desc: "오렌지에서 얻은 영감" },
      "KC-6R4": { area: "본문", label: "동대문 디자인 플라자", desc: "자연의 곡선, 목적의 so that절" }
    };

    // === 교체 대상 ===
    const kcScores = {
      "KC-6C1": 100, "KC-6C2": 100, "KC-6D1": 100, "KC-6D2": 100,
      "KC-6D3": 100, "KC-6D6": 100, "KC-6D9": 100, "KC-6G1": 82.6,
      "KC-6G2": 100, "KC-6R1": 94.9, "KC-6R2": 95.7, "KC-6R3": 100,
      "KC-6R4": 86.8, "KC-6V1": 100
    };

    const groups = [
      { id: "core", title: "A. 기반 지식", subtitle: "의사소통·문법·어휘 기반", items:["KC-6C1","KC-6C2","KC-6G1","KC-6G2","KC-6V1"] },
      { id: "dialogue", title: "B-1. 적용 · 대화문", subtitle: "실제 대화 상황 이해", items:["KC-6D1","KC-6D2","KC-6D3","KC-6D6","KC-6D9"] },
      { id: "reading", title: "B-2. 적용 · 본문", subtitle: "Nature Meets City: 자연에서 영감을 얻은 건축", items:["KC-6R1","KC-6R2","KC-6R3","KC-6R4"] }
    ];

    const typeScores = [
      { code:"112", name:"대화 내용 일치/불일치", area:"대화", score:100, kcs:["KC-6D1", "KC-6D3"] },
      { code:"113", name:"요약문 내용 일치/불일치", area:"대화", score:100, kcs:["KC-6C2", "KC-6D9"] },
      { code:"121", name:"대화 흐름 파악", area:"대화", score:100, kcs:["KC-6C1", "KC-6C2"] },
      { code:"122", name:"대화 순서 배열", area:"대화", score:100, kcs:["KC-6C1", "KC-6D1", "KC-6D3"] },
      { code:"124", name:"대화 빈칸 추론", area:"대화", score:93.8, kcs:["KC-6C1", "KC-6D1", "KC-6C2"] },
      { code:"133", name:"유사 표현 찾기", area:"대화", score:100, kcs:["KC-6C2", "KC-6D6"] },
      { code:"241", name:"문장 전환하기", area:"문법", score:100, kcs:["KC-6G1", "KC-6G2"] },
      { code:"242", name:"조건에 맞게 영작하기", area:"문법", score:91.7, kcs:["KC-6G1", "KC-6G2", "KC-6R4"] },
      { code:"251", name:"어법상 옳은/틀린 것 고르기", area:"문법", score:75, kcs:["KC-6R1", "KC-6R2", "KC-6G2"] },
      { code:"252", name:"어법 쓰임 구분", area:"문법", score:100, kcs:["KC-6R2", "KC-6R4", "KC-6G1", "KC-6G2"] },
      { code:"253", name:"빈칸에 적절한 어법/어휘", area:"문법", score:100, kcs:["KC-6R1", "KC-6R2", "KC-6R3", "KC-6R4"] },
      { code:"311", name:"글의 주제/제목 파악", area:"독해", score:66.7, kcs:["KC-6R1", "KC-6R2", "KC-6R3", "KC-6R4"] },
      { code:"312", name:"본문 내용 일치/불일치", area:"독해", score:100, kcs:["KC-6R1", "KC-6R2", "KC-6R3", "KC-6R4"] },
      { code:"321", name:"주어진 문장 넣기/흐름", area:"독해", score:100, kcs:["KC-6R1", "KC-6R2"] },
      { code:"322", name:"연결사 추론", area:"독해", score:100, kcs:["KC-6R3", "KC-6R4"] },
      { code:"325", name:"본문 빈칸 추론", area:"독해", score:100, kcs:["KC-6R1", "KC-6V1", "KC-6G1"] },
      { code:"331", name:"어휘 의미 파악", area:"독해", score:100, kcs:["KC-6V1", "KC-6R2"] },
      { code:"342", name:"영어로 답하기", area:"독해", score:100, kcs:["KC-6R2", "KC-6R3"] }
    ];

    // ======== 헬퍼 ========
    const thresholds = { excellent:85, ok:60 };
    const clamp = (n) => Math.max(0, Math.min(100, Number(n||0)));
    function statusColor(v, bgOnly=false){
      if(v==null) return bgOnly? '#e5e7eb' : 'background:#e5e7eb;color:#374151';
      if(v>=thresholds.excellent) return bgOnly? 'var(--green-100)' : 'background:var(--green-100);color:var(--green)';
      if(v>=thresholds.ok) return bgOnly? 'var(--yellow-100)' : 'background:var(--yellow-100);color:var(--yellow)';
      return bgOnly? 'var(--red-100)' : 'background:var(--red-100);color:var(--red)';
    }
    function barColor(v){
      if(v==null) return '#e5e7eb';
      if(v>=thresholds.excellent) return 'var(--green)';
      if(v>=thresholds.ok) return 'var(--yellow)';
      return 'var(--red)';
    }
    function scoreLabel(v) {
      if (v == null) return '미평가';
      const n = +v;
      return n === 100 ? '100%' : n.toFixed(1) + '%';
    }
    function average(nums){
      const vals = nums.filter(v => v!=null);
      if(!vals.length) return null;
      return vals.reduce((a,b)=>a+Number(b),0)/vals.length;
    }

    function getFeedbackHTML() {
      return `
        <h3>📊 상세 분석 및 맞춤 피드백</h3>
        <div>
          <p style="padding:12px; background-color: var(--gray-100); border-radius: 12px; font-size: 14px; margin-top:0;">
            <strong>총평:</strong> ${studentName} 학생은 전반적으로 매우 높은 성취도를 보이며 기본 개념이 탄탄하게 자리 잡고 있음을 확인했습니다. 특히 어휘(KC-6V1), 대화문(KC-6D 계열), 그리고 핵심 문법 중 하나인 'enough to' 구문(KC-6G2)에서는 100%의 완벽한 이해도를 보여주었습니다. 다만, 몇 가지 특정 유형과 지식 영역에서 약간의 보완점을 발견했습니다. 아래 분석 내용을 통해 어떤 부분을 조금 더 신경 쓰면 최상위권으로 도약할 수 있을지 확인해 보세요.
          </p>
        </div>
        <hr>
        <h4>📖 본문 독해: 전체를 아우르는 '제목' 찾기의 아쉬움</h4>
        <p class="summary">글의 세부 내용을 파악하는 능력(유형 312, 100%)은 매우 뛰어나지만, 글 전체의 핵심을 요약하여 주제나 제목으로 연결하는 능력(유형 311, 66.7%)에서 약간의 어려움을 겪고 있습니다. 이는 본문의 마지막 파트인 동대문 디자인 플라자(DDP)에 대한 이해도(KC-6R4, 86.8%)가 다른 본문 파트에 비해 소폭 낮은 것과 관련이 있을 수 있습니다.</p>
        <blockquote>
          <p><strong>대표 문제 예시 (독해 5번)</strong></p>
          <p><strong>[지문]</strong> What about Korea? Have you ever been to Dongdaemun Design Plaza in Seoul? Many people think that the building looks like a giant spaceship. But the architect, Zaha Hadid, took the curved lines from nature so that city people could enjoy them. Thanks to its special design, it has become a popular tourist attraction in Seoul.</p>
          <p><strong>[문제]</strong> 5. 다음 글의 제목으로 가장 적절한 것은?</p>
          <p><strong>[선택지]</strong> ... ③ How Dongdaemun Design Plaza Is Commonly Used ④ Another Landmark in Seoul, Dongdaemun Design Plaza ...</p>
          <p>➡️ <strong>정답: ④번</strong> / <strong>학생 답안: ③번</strong></p>
        </blockquote>
        <p class="analysis"><strong>분석:</strong> 이 실수는 지문의 내용을 부분적으로 이해했지만, 글쓴이가 전달하려는 핵심 의도를 파악하는 데서 비롯된 것으로 보입니다.
        <br><strong>오답 분석 (③번):</strong> ③번 선택지 'DDP가 일반적으로 어떻게 사용되는지'가 답이 되려면, 본문에 DDP에서 어떤 전시가 열리고, 어떤 행사가 진행되는지와 같은 '용도'에 대한 구체적인 설명이 있어야 합니다. 하지만 주어진 지문은 DDP의 독특한 '디자인'의 유래와 그로 인해 '유명 관광 명소'가 되었다는 '상징성'에 초점을 맞추고 있습니다.
        <br><strong>정답 분석 (④번):</strong> ④번 선택지 '서울의 또 다른 랜드마크, DDP'는 본문의 내용을 가장 잘 요약합니다. '서울에 있는 DDP에 가본 적 있나요?'라고 물으며 장소를 소개하고, '유명 관광 명소(a popular tourist attraction)'가 되었다는 점을 직접적으로 언급하며 DDP가 서울의 중요한 '랜드마크'임을 명확히 보여줍니다.</p>
        <hr>
        <h4>✍️ 문법: 아는 지식을 '확인'하는 마지막 단계의 실수</h4>
        <p class="summary">문법 지식 자체는 훌륭하지만, 여러 문법 사항의 정오를 동시에 판단해야 하는 복합적인 문제(유형 251, 75%)에서 실수가 발생했습니다. 이는 아는 것을 실수로 틀리는 경우로, 꼼꼼하게 최종 검토하는 습관을 통해 충분히 극복할 수 있습니다.</p>
        <blockquote>
          <p><strong>대표 문제 예시 (대단원평가 4번)</strong></p>
          <p><strong>[문제]</strong> 4. 윗글의 밑줄 친 ⓐ~ⓖ 중 문법적으로 올바른 것의 개수는?</p>
          <p><strong>[지문 및 문법 포인트]</strong> ... (본문 일부) The shapes in nature <code>is</code> very pleasing ... (본문 일부) It is one of the most famous <code>church</code> in the world. ... (나머지 5개는 문법적으로 올바른 문장)</p>
          <p><strong>[선택지]</strong> ① 3개 ② 4개 ③ (정답) 5개 ④ 6개 ⑤ 7개</p>
          <p>➡️ <strong>정답: ③번(5개)</strong> / <strong>학생 답안: ②번 (4개)</strong></p>
        </blockquote>
        <p class="analysis"><strong>분석:</strong> ${studentName} 학생은 문법적으로 틀린 문장 2개 중 1개만 찾아내고, 나머지 1개의 오류를 놓쳐 정답 개수를 잘못 선택한 것으로 보입니다.
        <br>학생은 <code>The shapes ... is</code>가 <code>are</code>로 바뀌어야 한다는 주어-동사 수일치 오류는 파악했을 가능성이 높습니다. 하지만 ‘가장 ~한 것들 중 하나’라는 의미의 <strong>‘one of the + 최상급 + 복수명사’</strong> 구문에서 <code>church</code>가 단수형으로 쓰여 틀렸다는 점을 놓쳤을 가능성이 큽니다. 이 패턴은 문법 문제에서 매우 자주 등장하는 핵심 규칙이므로, ‘one of the’가 보이면 항상 뒤에 복수명사가 왔는지 확인하는 습관을 들이는 것이 중요합니다. 이처럼 복합 문제에서는 아는 문법이라도 하나씩 소거하며 끝까지 확인하는 꼼꼼함이 정답률을 높이는 열쇠가 됩니다.</p>
      `;
    }

    // ======== 렌더링 ========
    const mount = document.getElementById('mount');
    const searchEl = document.getElementById('search');
    const focusBox = document.getElementById('focusBox');
    let currentView = 'all';

    function render(){
      const q = (searchEl.value||'').trim().toLowerCase();
      mount.innerHTML = '';
      focusBox.style.display = currentView === 'feedback' ? 'none' : 'block';

      ['core','dialogue','reading'].forEach(id => {
        if(!(currentView==='all' || currentView===id)) return;
        const g = groups.find(x=>x.id===id);
        const items = g.items.filter(k => {
          if(!q) return true;
          const m = kcMeta[k]||{};
          return k.toLowerCase().includes(q) || (m.label||'').toLowerCase().includes(q) || (m.desc||'').toLowerCase().includes(q) || (m.area||'').toLowerCase().includes(q);
        });
        if(!items.length) return;

        const sec = document.createElement('section');
        sec.className = 'card p-20';
        sec.style.marginTop = '16px';
        sec.innerHTML = `
          <div class="between">
            <div>
              <div class="title" style="font-size:18px">${id==='core'?'🧩':id==='dialogue'?'💬':'📖'} ${g.title}</div>
              <div class="sub muted">${g.subtitle}</div>
            </div>
          </div>
        `;
        const grid = document.createElement('div');
        grid.className = 'grid grid-2 grid-3';
        grid.style.marginTop = '12px';
        items.forEach(k => grid.appendChild(KCCard(k)));
        sec.appendChild(grid);
        mount.appendChild(sec);
      });

      if(currentView==='all' || currentView==='types'){
        const filteredTypes = typeScores.filter(t => {
          if(!q) return true;
          return (t.name+t.code+t.area+(t.kcs||[]).join(',')).toLowerCase().includes(q);
        });
        if(filteredTypes.length){
          const sec = document.createElement('section');
          sec.className = 'card p-20';
          sec.style.marginTop = '16px';
          sec.innerHTML = `<div class="between"><div><div class="title" style="font-size:18px">📝 문제 유형 성취도</div><div class="sub muted">각 유형이 연계하는 KC와 성취도를 함께 확인</div></div></div>`;
          const grid = document.createElement('div');
          grid.className = 'grid grid-2';
          grid.style.marginTop = '12px';
          filteredTypes.forEach(t => grid.appendChild(TypeCard(t)));
          sec.appendChild(grid);
          mount.appendChild(sec);
        }
      }

      if(currentView==='all' || currentView==='feedback'){
        const sec = document.createElement('section');
        sec.className = 'card p-24 feedback-section';
        sec.style.marginTop = '16px';
        sec.innerHTML = getFeedbackHTML();
        mount.appendChild(sec);
      }

      const avgKCVal = average(Object.values(kcScores));
      document.getElementById('avgKC').textContent = avgKCVal==null? '미평가' : `${avgKCVal.toFixed(1)}%`;
      document.getElementById('avgKCBar').style.width = (avgKCVal==null?0:clamp(avgKCVal))+'%';
      document.getElementById('avgKCBar').style.background = barColor(avgKCVal);

      const avgTypeVal = average(typeScores.map(t=>t.score));
      document.getElementById('avgType').textContent = avgTypeVal==null? '미평가' : `${avgTypeVal.toFixed(1)}%`;
      document.getElementById('avgTypeBar').style.width = (avgTypeVal==null?0:clamp(avgTypeVal))+'%';
      document.getElementById('avgTypeBar').style.background = barColor(avgTypeVal);

      renderFocus();
    }

    function KCCard(id){
      const m = kcMeta[id]||{}; const v = kcScores[id];
      const el = document.createElement('div');
      el.className = 'card p-16'; el.style.borderColor = '#e5e7eb';
      el.innerHTML = `
        <div class="kc-card">
          <div class="kc-ico">${m.area==='의사소통'?'💬':m.area==='문법'?'✍️':m.area==='어휘'?'🔤':m.area==='대화문'?'💬':'📖'}</div>
          <div style="flex:1;min-width:0">
            <div class="row" style="align-items:center;gap:6px;flex-wrap:wrap">
              <span class="small" style="font-weight:700">${id}</span>
              <span class="pill" style="${statusColor(v)}">${scoreLabel(v)}</span>
            </div>
            <div class="small" style="font-weight:700;margin-top:4px">${m.label||''}</div>
            <div class="small muted" style="margin-top:2px">${m.desc||''}</div>
            <div class="hbar" style="margin-top:8px"><span style="width:${clamp(v||0)}%; background:${barColor(v)}"></span></div>
          </div>
        </div>
      `;
      return el;
    }

    function TypeCard(t){
      const el = document.createElement('div');
      el.className = 'card p-16';
      const related = (t.kcs||[]).map(k=>`${k} (${scoreLabel(kcScores[k])})`).join(' · ');
      el.innerHTML = `
        <div class="type-card">
          <div style="min-width:0">
            <div class="row" style="gap:6px;flex-wrap:wrap">
              <span class="small" style="font-weight:700">${t.name}</span>
              <span class="small muted">[${t.code}]</span>
              <span class="pill" style="background:#f3f4f6;color:#374151">${t.area}</span>
            </div>
            <div class="small muted" style="margin-top:4px">연계 KC: ${related}</div>
          </div>
          <div style="text-align:right;min-width:120px">
            <div style="font-weight:700">${scoreLabel(t.score)}</div>
            <div class="hbar" style="margin-top:6px"><span style="width:${clamp(t.score||0)}%; background:${barColor(t.score)}"></span></div>
          </div>
        </div>
      `;
      return el;
    }

    function renderFocus(){
      const list = document.getElementById('focusList');
      const entries = Object.entries(kcScores)
        .filter(([k,v])=>v!=null && v < thresholds.excellent)
        .sort((a,b)=> (a[1]-b[1]) || (kcMeta[a[0]].area > kcMeta[b[0]].area ? 1 : -1))
        .slice(0,3);

      const tips = {
        'KC-6G1': "'so that' 구문이 포함된 문장을 직접 영작하는 연습을 해보세요.",
        'KC-6R4': "DDP(동대문 디자인 플라자) 문단의 핵심 내용을 한 문장으로 요약해보세요.",
      };

      list.innerHTML = entries.map(([k,v])=>{
        const m = kcMeta[k]||{}; const tip = tips[k]||'핵심 개념 복습 후 관련 문제를 풀어보세요.';
        return `<li style="margin:6px 0"><strong>${k}</strong> (${m.label}) — <span class="pill" style="${statusColor(v)}">${scoreLabel(v)}</span><br><span class="muted">처방: ${tip}</span></li>`;
      }).join('') || '<li class="muted">집중 보완이 필요한 영역이 없습니다. 잘하고 있어요!</li>';
    }

    document.getElementById('printBtn').addEventListener('click', () => window.print());
    document.querySelectorAll('.view-btn').forEach(btn => {
      btn.addEventListener('click', () => {
        document.querySelectorAll('.view-btn').forEach(b=>b.classList.remove('active'));
        btn.classList.add('active');
        currentView = btn.dataset.view;
        render();
      });
    });
    document.getElementById('search').addEventListener('input', render);

    render();
  </script>
</body>
</html>